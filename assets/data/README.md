# 📁 מבנה תיקיית `assets/data/`

תיקייה זו מכילה את כל נתוני המוצרים לאפליקציית רשימת הקניות.

---

## 📂 מבנה התיקיות

```
assets/
├── data/
│   ├── list_types/          ✅ קבצי מוצרים לפי סוג רשימה
│   │   ├── supermarket.json
│   │   ├── market.json
│   │   ├── bakery.json
│   │   ├── butcher.json
│   │   ├── greengrocer.json
│   │   └── pharmacy.json
│   ├── IMAGE_URLS.md        ✅ רשימת קישורי תמונות
│   └── README.md            ✅ תיעוד זה
│
├── templates/               ✅ תבניות רשימות מוכנות
│   ├── list_templates.json
│   ├── event_bbq.json
│   ├── shopping_weekly.json
│   └── pantry_basic.json
│
├── images/                  ✅ תמונות
│   ├── placeholder.png
│   └── snichel.png
│
└── fonts/                   ✅ פונטים
    ├── Assistant-Regular.ttf
    └── Assistant-Bold.ttf
```

---

## 📄 תיאור הקבצים

### `list_types/` - קבצי מוצרים לפי סוג רשימה

כל קובץ JSON מכיל מוצרים **רלוונטיים לסוג הרשימה** (לא מסודר לפי קטגוריה).

#### פורמט המוצר:
```json
{
  "name": "שם המוצר",
  "category": "קטגוריה (מאפים, ירקות, וכו')",
  "icon": "🍞",
  "price": 10.0,
  "barcode": "7290001234567",
  "brand": "שם המותג",      // אופציונלי - לא קיים אם אין מותג
  "unit": "יחידה / 100 גרם / ליטר"
}
```

> **הערה:** שדה `brand` הוא אופציונלי. מוצרים ללא מותג ספציפי לא יכילו את השדה.

#### קבצים:

| קובץ | תיאור | דוגמאות מוצרים |
|------|-------|----------------|
| **supermarket.json** | כל המוצרים (הכי מקיף) | חלב, לחם, ירקות, בשר, ניקיון... |
| **bakery.json** | מוצרים למאפייה | לחם, חלה, בורקס, עוגיות, קרואסון |
| **butcher.json** | מוצרים לקצב | בשר בקר, עוף, כבש, נקניקים |
| **greengrocer.json** | מוצרים לירקן | עגבניות, מלפפון, בצל, תפוחים, בננות |
| **pharmacy.json** | מוצרים לבית מרקחת | תרופות, ויטמינים, חיתולים, משחת שיניים, קוסמטיקה |
| **market.json** | מוצרים לשוק | כל סוגי המוצרים לשוק |

---

## 🔄 עדכון מחירים ומוצרים

### סקריפט: `scripts/update_products.dart`

הסקריפט מעדכן מחירים ומוסיף מוצרים חדשים מ-Shufersal.

#### 🚀 הרצה:
```bash
dart run scripts/update_products.dart
```

#### מה הסקריפט עושה?
1. ✅ **מוריד מוצרים** מ-Shufersal (קבצי XML.gz פומביים)
2. ✅ **מעדכן מחירים** למוצרים קיימים (לפי barcode)
3. ✅ **מוסיף מוצרים חדשים** אם אין ברשימה
4. ✅ **יוצר גיבוי** לפני כל שינוי
5. ✅ **מיפוי חכם** - מוסיף מוצרים לקובץ הנכון לפי קטגוריה

#### תצורה (בתוך הסקריפט):
```dart
const int maxFilesToFetch = 3;  // כמה קבצים להוריד מ-Shufersal
const double minPrice = 0.5;    // מחיר מינימלי (להתעלמות ממוצרי שגיאה)
```

---

## 🛠️ סקריפטים נוספים

### `scripts/fix_json_categories.dart`
תיקון אוטומטי של קטגוריות שגויות בקבצי JSON.

```bash
dart run scripts/fix_json_categories.dart
```

**דוגמה:**
- "לחם לבן" שמסווג כ-"מוצרי חלב" → מתוקן ל-"מאפים"

### `scripts/clean_empty_brands.dart`
ניקוי ערכי brand ריקים או חסרי משמעות מכל קבצי JSON.

```bash
dart scripts/clean_empty_brands.dart
```

**מה מנקה:**
- `""` (מחרוזת ריקה)
- `"---"` או `"-"`
- `"כללי"`
- ערכים עם רווחים בלבד

---

## ⚠️ חשוב לדעת

### 1. **`list_types/` הוא המקור היחיד**
האפליקציה קוראת **רק** מ-`list_types/`.
כל שינוי חייב להתבצע בקבצים האלה.

### 2. **קטגוריות מעורבות**
כל קובץ יכול להכיל **מספר קטגוריות**.
לדוגמה, `bakery.json` יכול להכיל:
- מאפים (לחם, בורקס)
- משקאות (קפה לקניה במאפייה)
- מוצרי חלב (חמאה, חלב)

### 3. **Barcode הוא המזהה הייחודי**
כאשר מעדכנים מחירים, הסקריפט מזהה מוצרים לפי barcode.

### 4. **גיבויים אוטומטיים**
כל שינוי יוצר קובץ גיבוי עם סיומת `.backup`.
אפשר למחוק אותם לאחר וידוא שהשינויים תקינים.

---

## 📊 סטטיסטיקה (עדכני)

| קובץ | מוצרים |
|------|--------|
| **supermarket.json** | 1,701 מוצרים |
| **market.json** | 371 מוצרים |
| **pharmacy.json** | 101 מוצרים |
| **butcher.json** | 92 מוצרים |
| **greengrocer.json** | 75 מוצרים |
| **bakery.json** | 40 מוצרים |
| **סה"כ** | **2,380 מוצרים** |

---

## 🧹 תיקונים שבוצעו לאחרונה

### ✅ תיקוני pharmacy.json (06.01.2026)
- ✅ תוקנו שגיאות כתיב במותגים:
  - "רקיט בנקיזר" → "רקיט בנקייזר" (נורופן)
  - "אקו-צ'ק" → "אקיו-צ'ק" (מדי סוכר)
  - "סיגוריס" → "סיגווריס" (גרביים רפואיות)
- ✅ תוקן מותג אדוויל: GSK → Pfizer
- ✅ סופרדין הועבר לקטגוריה נכונה (ויטמינים) ותוקן מותג: GSK → באייר
- ✅ הורחבה הרשימה ל-101 מוצרים כולל: תרופות, ויטמינים, מוצרי תינוקות, טיפוח הפה, קוסמטיקה, עזרה ראשונה, מוצרי ניקיון

### ✅ תיקוני supermarket.json
- ✅ תוקנו **149 מוצרים** עם תווי backslash מיותרים במותגים (`בע\"מ` → `בע"מ`)
- ✅ תוקנו **8 מוצרים** עם רווחים כפולים בשמות ומותגים
- ✅ הקובץ עכשיו נקי לחלוטין משגיאות כתיב וקידוד

### ✅ ניקוי ערכי brand ריקים (29.12.2025)
- ✅ הוסרו **471 ערכי brand ריקים** מכל הקבצים:
  - supermarket.json: 275
  - greengrocer.json: 75
  - market.json: 60
  - butcher.json: 33
  - bakery.json: 28
- ✅ שדה `brand` הפך לאופציונלי - לא קיים אם אין מותג ספציפי

---

## 🎯 סיכום

- ✅ **מבנה נקי** עם תיקייה אחת למוצרים: `list_types/`
- ✅ **סקריפט יחיד** לעדכון מחירים: `update_products.dart`
- ✅ **תיעוד מלא** במסמך זה
- ✅ **קל לתחזוקה** וקל להבנה

---

**תאריך עדכון אחרון:** 06.01.2026 ✨
