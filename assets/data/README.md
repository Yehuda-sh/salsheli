# 📁 מבנה תיקיית `assets/data/`

תיקייה זו מכילה את כל נתוני המוצרים לאפליקציית רשימת הקניות.

---

## 📂 מבנה התיקיות

```
assets/
├── data/
│   ├── list_types/          ✅ קבצי מוצרים לפי סוג רשימה
│   │   ├── supermarket.json
│   │   ├── market.json
│   │   ├── bakery.json
│   │   ├── butcher.json
│   │   ├── greengrocer.json
│   │   └── pharmacy.json
│   ├── IMAGE_URLS.md        ✅ רשימת קישורי תמונות
│   └── README.md            ✅ תיעוד זה
│
├── templates/               ✅ תבניות רשימות מוכנות
│   ├── list_templates.json
│   ├── event_bbq.json
│   ├── shopping_weekly.json
│   └── pantry_basic.json
│
├── images/                  ✅ תמונות
│   ├── placeholder.png
│   └── snichel.png
│
└── fonts/                   ✅ פונטים
    ├── Assistant-Regular.ttf
    └── Assistant-Bold.ttf
```

---

## 📄 תיאור הקבצים

### `list_types/` - קבצי מוצרים לפי סוג רשימה

כל קובץ JSON מכיל מוצרים **רלוונטיים לסוג הרשימה** (לא מסודר לפי קטגוריה).

#### פורמט המוצר:
```json
{
  "name": "שם המוצר",
  "category": "קטגוריה (מאפים, ירקות, וכו')",
  "icon": "🍞",
  "price": 10.0,
  "barcode": "7290001234567",
  "brand": "שם המותג",
  "unit": "יחידה / 100 גרם / ליטר"
}
```

#### קבצים:

| קובץ | תיאור | דוגמאות מוצרים |
|------|-------|----------------|
| **supermarket.json** | כל המוצרים (הכי מקיף) | חלב, לחם, ירקות, בשר, ניקיון... |
| **bakery.json** | מוצרים למאפייה | לחם, חלה, בורקס, עוגיות, קרואסון |
| **butcher.json** | מוצרים לקצב | בשר בקר, עוף, כבש, נקניקים |
| **greengrocer.json** | מוצרים לירקן | עגבניות, מלפפון, בצל, תפוחים, בננות |
| **pharmacy.json** | מוצרים לבית מרקחת | תרופות, ויטמינים, חיתולים, משחת שיניים, קוסמטיקה |
| **market.json** | מוצרים לשוק | כל סוגי המוצרים לשוק |

---

## 🔄 עדכון מחירים ומוצרים

### סקריפט: `scripts/update_products.dart`

הסקריפט מעדכן מחירים ומוסיף מוצרים חדשים מ-Shufersal.

#### 🚀 הרצה:
```bash
dart run scripts/update_products.dart
```

#### מה הסקריפט עושה?
1. ✅ **מוריד מוצרים** מ-Shufersal (קבצי XML.gz פומביים)
2. ✅ **מעדכן מחירים** למוצרים קיימים (לפי barcode)
3. ✅ **מוסיף מוצרים חדשים** אם אין ברשימה
4. ✅ **יוצר גיבוי** לפני כל שינוי
5. ✅ **מיפוי חכם** - מוסיף מוצרים לקובץ הנכון לפי קטגוריה

#### תצורה (בתוך הסקריפט):
```dart
const int maxFilesToFetch = 3;  // כמה קבצים להוריד מ-Shufersal
const double minPrice = 0.5;    // מחיר מינימלי (להתעלמות ממוצרי שגיאה)
```

---

## 🛠️ סקריפטים נוספים

### `scripts/fix_json_categories.dart`
תיקון אוטומטי של קטגוריות שגויות בקבצי JSON.

```bash
dart run scripts/fix_json_categories.dart
```

**דוגמה:**
- "לחם לבן" שמסווג כ-"מוצרי חלב" → מתוקן ל-"מאפים"

---

## ⚠️ חשוב לדעת

### 1. **`list_types/` הוא המקור היחיד**
האפליקציה קוראת **רק** מ-`list_types/`.
כל שינוי חייב להתבצע בקבצים האלה.

### 2. **קטגוריות מעורבות**
כל קובץ יכול להכיל **מספר קטגוריות**.
לדוגמה, `bakery.json` יכול להכיל:
- מאפים (לחם, בורקס)
- משקאות (קפה לקניה במאפייה)
- מוצרי חלב (חמאה, חלב)

### 3. **Barcode הוא המזהה הייחודי**
כאשר מעדכנים מחירים, הסקריפט מזהה מוצרים לפי barcode.

### 4. **גיבויים אוטומטיים**
כל שינוי יוצר קובץ גיבוי עם סיומת `.backup`.
אפשר למחוק אותם לאחר וידוא שהשינויים תקינים.

---

## 📊 סטטיסטיקה (עדכני)

| קובץ | גודל | מוצרים |
|------|------|--------|
| **supermarket.json** | 394KB | 1,701 מוצרים |
| **market.json** | 86KB | 371 מוצרים |
| **butcher.json** | 24KB | 92 מוצרים |
| **pharmacy.json** | 14KB | 61 מוצרים |
| **greengrocer.json** | 13KB | 75 מוצרים |
| **bakery.json** | 8KB | 40 מוצרים |
| **סה"כ** | **~540KB** | **2,340 מוצרים** |

---

## 🧹 תיקונים שבוצעו לאחרונה

### ✅ תיקוני pharmacy.json
- ✅ הוסרו כל מוצרי המזון (זרעי פשתן, טורטיות, תבלינים, תערובות אפייה)
- ✅ תוקנה קטגוריזציה (מרכך שיער, קצף גילוח, מטליות)
- ✅ נוספו מוצרים רלוונטיים לבית מרקחת:
  - 💊 תרופות ללא מרשם (7 מוצרים)
  - 🌞 ויטמינים ותוספי תזונה (7 מוצרים)
  - 👶 מוצרי תינוקות (9 מוצרים)
  - 🦷 טיפוח הפה (7 מוצרים)
  - 💆 קוסמטיקה וטיפוח (5 מוצרים)
  - 🩹 עזרה ראשונה (6 מוצרים)

### ✅ תיקוני supermarket.json
- ✅ תוקנו **149 מוצרים** עם תווי backslash מיותרים במותגים (`בע\"מ` → `בע"מ`)
- ✅ תוקנו **8 מוצרים** עם רווחים כפולים בשמות ומותגים
- ✅ הקובץ עכשיו נקי לחלוטין משגיאות כתיב וקידוד

---

## 🎯 סיכום

- ✅ **מבנה נקי** עם תיקייה אחת למוצרים: `list_types/`
- ✅ **סקריפט יחיד** לעדכון מחירים: `update_products.dart`
- ✅ **תיעוד מלא** במסמך זה
- ✅ **קל לתחזוקה** וקל להבנה

---

**תאריך עדכון אחרון:** 20.11.2025 ✨
