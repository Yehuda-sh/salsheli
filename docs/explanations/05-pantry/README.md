# 📱 מזווה (מלאי בבית)

## 🎯 מה זה עושה?

המזווה הוא המסך שמראה **מה יש לך בבית**.
מאפשר ליוגב:
- לראות את כל המוצרים שיש לו בבית
- לסדר לפי מיקום (מקרר, מקפיא, ארון)
- להוסיף מוצרים חדשים
- לעדכן כמויות
- לקבל התראה כשמשהו נגמר

---

## 📱 איך נראה המסך

```
┌─────────────────────────────────────────────────────────┐
│  📦 המזווה שלי                           🔍 חיפוש     │
├─────────────────────────────────────────────────────────┤
│  [הכל] [🧊 מקפיא] [🧊 מקרר] [🗄️ ארון] [📦 אחר]        │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  🧊 מקרר                                               │
│  ┌────────────────────────────────────────────────────┐│
│  │ 🥛 חלב 3%                                         ││
│  │    כמות: 2 יחידות                                  ││
│  │    תוקף: 18/01/2024                               ││
│  └────────────────────────────────────────────────────┘│
│  ┌────────────────────────────────────────────────────┐│
│  │ 🧀 גבינה צהובה                                    ││
│  │    כמות: 1 אריזה                                   ││
│  │    ⚠️ נמוך במלאי!                                 ││
│  └────────────────────────────────────────────────────┘│
│                                                         │
│  🧊 מקפיא                                              │
│  ┌────────────────────────────────────────────────────┐│
│  │ 🍖 חזה עוף                                        ││
│  │    כמות: 3 אריזות                                  ││
│  └────────────────────────────────────────────────────┘│
│                                                         │
├─────────────────────────────────────────────────────────┤
│                              [ + הוסף מוצר למזווה ]     │
└─────────────────────────────────────────────────────────┘
```

---

## 🔄 זרימה - הוספת מוצר למזווה

```
┌─────────────────────────────────────────────────────────┐
│  יוגב לוחץ "+ הוסף מוצר למזווה"                         │
└──────────────────────┬──────────────────────────────────┘
                       ↓
┌─────────────────────────────────────────────────────────┐
│  נפתח דיאלוג הוספה:                                    │
│  • בחר מוצר (מהקטלוג או חדש)                           │
│  • כמות: 1                                              │
│  • מיקום: מקרר 🧊                                       │
│  • תאריך תפוגה (אופציונלי)                              │
└──────────────────────┬──────────────────────────────────┘
                       ↓
┌─────────────────────────────────────────────────────────┐
│  יוגב לוחץ "הוסף"                                       │
└──────────────────────┬──────────────────────────────────┘
                       ↓
              המוצר נשמר ב-Firebase
              מופיע ברשימת המזווה
```

---

## 📖 דוגמה - יוגב חוזר מהסופר

**הסיטואציה:** יוגב חזר מהסופר עם קניות ורוצה לעדכן את המזווה

**מה יוגב עושה:**
1. פותח את טאב "מזווה" 📦
2. לוחץ "+ הוסף מוצר"
3. מחפש "חלב"
4. בוחר "חלב 3% ליטר"
5. מכניס כמות: 3
6. בוחר מיקום: מקרר
7. לוחץ "הוסף"

**מה נשמר:**
```
inventory/פריט_id:
  product_name: "חלב 3% ליטר"
  category: "מוצרי חלב"
  quantity: 3
  unit: "יחידות"
  location: "fridge"
  household_id: "house_abc123"
  added_at: timestamp
  expiry_date: null
  min_quantity: 1  // מתחת לזה - התראה
```

---

## 🗂️ מיקומי אחסון

| מיקום | אייקון | דוגמאות מוצרים |
|-------|--------|---------------|
| מקרר | 🧊 | חלב, גבינות, ירקות |
| מקפיא | ❄️ | בשר, ירקות קפואים |
| ארון מטבח | 🗄️ | שימורים, אורז, פסטה |
| מזווה/מחסן | 📦 | קופסאות שימורים |
| אחר | 📍 | כל השאר |

---

## 📖 דוגמה - יוגב רואה שהחלב נגמר

**הסיטואציה:** יוגב שותה את החלב האחרון

**מה יוגב עושה:**
1. פותח את המזווה
2. מוצא את "חלב 3%"
3. לוחץ על הפריט
4. משנה כמות מ-1 ל-0 (או מוחק)

**מה קורה:**
- אם הכמות יורדת מתחת ל-`min_quantity`:
  - מופיעה התראה "⚠️ נמוך במלאי!"
  - (בעתיד: שליחת Push Notification)

---

## 💡 הצעות חכמות

המזווה יודע להציע מוצרים לרשימת הקניות:

```
אם חלב (כמות: 1) והמינימום הוא 2
   ↓
"הצעה: להוסיף חלב לרשימת הקניות?"
```

---

## 💾 איפה המידע נשמר?

### קבצים ותפקידים

| קובץ | מה הוא עושה? |
|------|-------------|
| [my_pantry_screen.dart](../../../lib/screens/pantry/my_pantry_screen.dart) | מסך המזווה |
| [inventory_provider.dart](../../../lib/providers/inventory_provider.dart) | "הזיכרון" - שומר את פריטי המזווה |
| [inventory_item.dart](../../../lib/models/inventory_item.dart) | "התבנית" - מבנה של פריט במזווה |
| [storage_locations_config.dart](../../../lib/config/storage_locations_config.dart) | הגדרות מיקומי אחסון |

### מבנה נתונים ב-Firebase

```
households/house_abc123/inventory/פריט_id:
  product_name: "חלב 3% ליטר"
  category: "מוצרי חלב"
  quantity: 2
  unit: "יחידות"
  location: "fridge"
  expiry_date: "2024-01-18"
  min_quantity: 1
  added_at: timestamp
  updated_at: timestamp
  added_by: "יוגב_id"
```

---

## 🔄 סנכרון אוטומטי

המזווה מתעדכן אוטומטית:

1. **אחרי קנייה** - מוצרים שנקנו מתווספים למזווה
2. **כל בני הבית רואים** - עדכון אחד משפיע על כולם
3. **זמן אמת** - שינויים מסתנכרנים מיד

```
יוגב מוסיף חלב (מהטלפון שלו)
           ↓
        Firebase
           ↓
שרה רואה את החלב (בטלפון שלה)
```

---

## ⚠️ דברים לבדוק

### עובד:
- ✅ הוספת פריטים למזווה
- ✅ עדכון כמויות
- ✅ מחיקת פריטים
- ✅ סינון לפי מיקום
- ✅ חיפוש מוצרים
- ✅ קיבוץ לפי מיקום

### לבדוק:
- ❓ האם יש התראות על מוצרים שנגמרים?
- ❓ האם יש תזכורת לתאריכי תפוגה?
- ❓ איך מתווספים מוצרים אוטומטית מקנייה?

---

## 🔗 קישורים בין מסכים

```
     MainNavigationScreen
            │
     Tab 1: מזווה
            ↓
      MyPantryScreen
            │
    "+ הוסף מוצר"
            ↓
   PantryProductSelectionSheet
            │
    "הוסף למזווה"
            ↓
      PantryItemDialog
            │
        "שמור"
            ↓
     חזרה למזווה (מתעדכן)
```

---

## 📝 סיכום

המזווה עוזר ליוגב לדעת **מה יש לו בבית**.

**יתרונות:**
- לא שוכחים לקנות דברים שנגמרו
- לא קונים דברים שכבר יש
- כל המשפחה רואה את אותו מלאי

**המידע זורם:**
```
יוגב → MyPantryScreen → InventoryProvider → Firebase
                                  ↓
                         כל בני הבית (סנכרון)
```

**קשר לקנייה:**
```
ActiveShoppingScreen (סיום קנייה)
           ↓
    מוצרים שנקנו
           ↓
   InventoryProvider
           ↓
    המזווה מתעדכן
```
