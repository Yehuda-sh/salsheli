# 📱 קבוצות ושיתוף

## 🎯 מה זה עושה?

קבוצות מאפשרות ליוגב **לשתף רשימות עם אנשים אחרים**.
אפשרויות שיתוף:
- **משפחה** - כל בני הבית רואים הכל
- **קבוצה** - קבוצה ספציפית (חברים, ועד בית)
- **שיתוף ספציפי** - אנשים מסוימים

---

## 📱 איך נראה מסך הקבוצות

```
┌─────────────────────────────────────────────────────────┐
│  👥 הקבוצות שלי                         🔍 חיפוש       │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  ┌────────────────────────────────────────────────────┐ │
│  │ 🏠 משפחת כהן                                      │ │
│  │    5 חברים                                        │ │
│  │    אתה מנהל                                       │ │
│  └────────────────────────────────────────────────────┘ │
│                                                         │
│  ┌────────────────────────────────────────────────────┐ │
│  │ 🎂 יום הולדת דני                                  │ │
│  │    8 חברים                                        │ │
│  │    הוזמנת                                         │ │
│  └────────────────────────────────────────────────────┘ │
│                                                         │
├─────────────────────────────────────────────────────────┤
│               [ + צור קבוצה חדשה ]                      │
└─────────────────────────────────────────────────────────┘
```

---

## 🔄 זרימה - יצירת קבוצה חדשה

```
┌─────────────────────────────────────────────────────────┐
│  יוגב לוחץ "+ צור קבוצה חדשה"                           │
└──────────────────────┬──────────────────────────────────┘
                       ↓
┌─────────────────────────────────────────────────────────┐
│  נפתח מסך יצירת קבוצה:                                  │
│  • שם הקבוצה: "מסיבת על האש"                           │
│  • צבע: כתום 🟠                                         │
│  • אימוג'י: 🍖                                          │
└──────────────────────┬──────────────────────────────────┘
                       ↓
┌─────────────────────────────────────────────────────────┐
│  יוגב מזמין חברים:                                      │
│  • בוחר אנשי קשר מהטלפון                               │
│  • או מכניס אימייל/טלפון ידנית                         │
└──────────────────────┬──────────────────────────────────┘
                       ↓
┌─────────────────────────────────────────────────────────┐
│  יוגב לוחץ "צור קבוצה"                                  │
└──────────────────────┬──────────────────────────────────┘
                       ↓
         ┌─────────────┴─────────────┐
         ↓                           ↓
    [הצלחה]                  מוזמנים שאינם רשומים
         ↓                   מקבלים הזמנה ממתינה
    הקבוצה נוצרת
    יוגב הוא המנהל
```

---

## 📖 דוגמה - יוגב מזמין את שרה לקבוצה

**הסיטואציה:** יוגב רוצה לצרף את שרה (אשתו) לקבוצת המשפחה

**מה יוגב עושה:**
1. פותח את טאב "קבוצות" 👥
2. לוחץ על "משפחת כהן"
3. לוחץ "הזמן חברים"
4. בוחר את שרה מאנשי הקשר
5. לוחץ "שלח הזמנה"

**מה קורה לשרה:**
- אם שרה רשומה → מופיעה לה התראה 📬
- אם שרה לא רשומה → ההזמנה ממתינה

---

## 🔐 תפקידים בקבוצה

| תפקיד | מה יכול לעשות |
|-------|--------------|
| **מנהל** (Admin) | הכל - כולל מחיקת קבוצה והסרת חברים |
| **עורך** (Editor) | לערוך רשימות, להוסיף/להסיר מוצרים |
| **צופה** (Viewer) | רק לראות - בלי לערוך |

---

## 📬 הזמנות ממתינות

כשמישהו מזמין את יוגב לקבוצה:

```
┌─────────────────────────────────────────────────────────┐
│  📬 הזמנות ממתינות (2)                                  │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  ┌────────────────────────────────────────────────────┐ │
│  │ 🎂 יום הולדת דני                                  │ │
│  │    הוזמנת על ידי: דני לוי                         │ │
│  │                                                    │ │
│  │    [✅ אשר]        [❌ דחה]                       │ │
│  └────────────────────────────────────────────────────┘ │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

---

## 📖 דוגמה - יוגב מקבל הזמנה

**הסיטואציה:** דני הזמין את יוגב לקבוצת "על האש"

**מה יוגב רואה:**
1. בדף הבית - 📬 עם מספר (1)
2. לוחץ על ה-📬
3. רואה את ההזמנה מדני

**יוגב לוחץ "אשר":**
- יוגב מתווסף לקבוצה
- יוגב יכול לראות/לערוך את הרשימות של הקבוצה

**יוגב לוחץ "דחה":**
- ההזמנה נמחקת
- יוגב לא מצורף לקבוצה

---

## 💾 איפה המידע נשמר?

### קבצים ותפקידים

| קובץ | מה הוא עושה? |
|------|-------------|
| [groups_list_screen.dart](../../../lib/screens/groups/groups_list_screen.dart) | מסך רשימת הקבוצות |
| [create_group_screen.dart](../../../lib/screens/groups/create_group_screen.dart) | מסך יצירת קבוצה |
| [group_details_screen.dart](../../../lib/screens/groups/group_details_screen.dart) | מסך פרטי קבוצה |
| [pending_group_invites_screen.dart](../../../lib/screens/groups/pending_group_invites_screen.dart) | הזמנות ממתינות |
| [groups_provider.dart](../../../lib/providers/groups_provider.dart) | ניהול הקבוצות |
| [group.dart](../../../lib/models/group.dart) | מבנה קבוצה |

### מבנה נתונים ב-Firebase

**קבוצה:**
```
groups/קבוצה_id:
  name: "משפחת כהן"
  color: "#FF5722"
  emoji: "🏠"
  owner_id: "יוגב_id"
  created_at: timestamp
  members: [
    {
      user_id: "יוגב_id",
      role: "admin",
      joined_at: timestamp
    },
    {
      user_id: "שרה_id",
      role: "editor",
      joined_at: timestamp
    }
  ]
```

**הזמנה ממתינה:**
```
group_invites/הזמנה_id:
  group_id: "קבוצה_id"
  group_name: "משפחת כהן"
  inviter_id: "יוגב_id"
  invitee_email: "sara@gmail.com"
  status: "pending"  // pending, accepted, rejected
  created_at: timestamp
```

---

## ⚠️ דברים לבדוק

### עובד:
- ✅ יצירת קבוצה חדשה
- ✅ הזמנת חברים (רשומים ולא רשומים)
- ✅ אישור/דחיית הזמנות
- ✅ הצגת חברי קבוצה
- ✅ תפקידים (admin/editor/viewer)

### לבדוק:
- ❓ מה קורה כשמוחקים קבוצה?
- ❓ האם אפשר להעביר ניהול לחבר אחר?
- ❓ האם יש התראות Push להזמנות?

---

## 🔗 קישורים בין מסכים

```
MainNavigationScreen
       │
  Tab 2: קבוצות
       ↓
 GroupsListScreen
       │
       ├── "+ צור קבוצה" → CreateGroupScreen
       │
       └── לחיצה על קבוצה → GroupDetailsScreen
                              │
                              ├── "הזמן חברים"
                              └── "הגדרות קבוצה"
```

---

## 📝 סיכום

קבוצות מאפשרות **שיתוף פעולה** בין אנשים.

**סוגי קבוצות:**
- משפחה - שיתוף רשימות ומזווה
- קבוצת חברים - לאירועים
- שיתוף ספציפי - אדם מסוים

**תהליך:**
1. יוגב יוצר קבוצה
2. מזמין חברים
3. החברים מאשרים
4. כולם רואים את אותן רשימות
