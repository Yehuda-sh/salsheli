# תוכנית עבודה - MemoZap

> מסמך אפיון ותוכנית עבודה
> תאריך עדכון: 14/12/2025

---

## סיכום החלטות מהאפיון

### הרעיון המרכזי

MemoZap היא **מערכת רשימות גמישה** - לא רק קניות!
המפתח הוא **קבוצות**: אוסף משתמשים שפועלים יחד ויוצרים רשימות לפי הצורך.

### מבנה המערכת

```
משתמש:
├── רשימות פרטיות (/users/{userId}/private_lists/)
├── מזווה אישי (/users/{userId}/inventory/) ← רק אם לא במשפחה
└── חבר בקבוצות שונות (משפחה, ועד בית, ועד גן...)

קבוצה:
├── חברים עם הרשאות שונות
├── רשימות משותפות (לפי סוג)
└── מזווה משותף ← רק לקבוצת משפחה!
```

### סוגי קבוצות

| סוג קבוצה | מזווה | מצב קנייה | רשימות זמינות |
|-----------|-------|-----------|---------------|
| **משפחה** | ✅ כן | ✅ כן | קניות, צ'קליסט |
| **ועד בית** | ❌ לא | ❌ לא | הצבעה, צ'קליסט |
| **ועד גן** | ❌ לא | ❌ לא | מי מביא, צ'קליסט |
| **אחר** | ❌ לא | ❌ לא | כל הסוגים |

### הצטרפות למשפחה
- כשמשתמש מצטרף לקבוצת משפחה → המזווה האישי נמחק (עם אישור)
- מעכשיו משתמש במזווה המשפחתי

---

## מערכת קבוצות

### יצירת קבוצה (כמו וואטסאפ)

```
┌─────────────────────────────────────┐
│ יצירת קבוצה חדשה                    │
├─────────────────────────────────────┤
│ 📷 [הוסף תמונה]                     │
│                                     │
│ שם הקבוצה: [ועד בית הרצל 5]        │
│                                     │
│ סוג קבוצה:                          │
│ ○ משפחה                             │
│ ○ ועד בית                           │
│ ○ ועד גן                            │
│ ○ אחר                               │
│                                     │
│ הוסף חברים:                         │
│ ┌─────────────────────────────────┐ │
│ │ 🔍 חיפוש אנשי קשר...            │ │
│ ├─────────────────────────────────┤ │
│ │ ✓ יוסי (050-123...)  [אדמין ▼] │ │
│ │ ✓ רונית (052-456...) [חבר ▼]   │ │
│ │ ☐ דני (054-789...)             │ │
│ └─────────────────────────────────┘ │
│                                     │
│            [צור קבוצה]              │
└─────────────────────────────────────┘
```

### מבנה קבוצה ב-Firestore

```
/groups/{groupId}
├── name: "ועד בית הרצל 5"
├── type: "building" | "kindergarten" | "family" | "other"
├── image_url: "..." | null
├── created_by: "user_abc"
├── created_at: timestamp
├── members: {
│   "user_abc": { role: "owner", joined_at: timestamp },
│   "user_def": { role: "admin", joined_at: timestamp },
│   "user_ghi": { role: "member", joined_at: timestamp },
│ }
└── settings: {
    notifications: true,
    ...
  }
```

### הרשאות בקבוצה

| פעולה | בעלים | אדמין | חבר |
|-------|-------|-------|-----|
| צפייה בקבוצה | ✅ | ✅ | ✅ |
| יצירת רשימות | ✅ | ✅ | ❌ |
| הזמנת חברים | ✅ | ✅ | ❌ |
| הסרת חברים | ✅ | ✅ (לא אדמינים) | ❌ |
| שינוי הרשאות | ✅ | ❌ | ❌ |
| עריכת פרטי קבוצה | ✅ | ✅ | ❌ |
| מחיקת קבוצה | ✅ | ❌ | ❌ |

### עזיבת קבוצה

```
כשחבר עוזב קבוצה:
1. סימוני "אני מביא" שלו מתבטלים
   → הפריטים חוזרים להיות פנויים לסימון
   → התראה לאדמינים: "יוסי עזב, הסימונים שלו בוטלו"

2. הצבעות שלו מוסרות מהסטטיסטיקה
   → הספירה מתעדכנת בזמן אמת

3. החבר מוסר מרשימת החברים
```

### מחיקת קבוצה

```
רק בעלים יכול למחוק קבוצה:

┌─────────────────────────────────────┐
│ ⚠️ מחיקת קבוצה                      │
│                                     │
│ האם למחוק את "ועד בית הרצל 5"?      │
│                                     │
│ פעולה זו תמחק:                      │
│ • את הקבוצה                         │
│ • את כל הרשימות (12 רשימות)         │
│ • לכל 8 החברים                      │
│                                     │
│ פעולה זו בלתי הפיכה!                │
│                                     │
│        [ביטול] [מחק קבוצה]          │
└─────────────────────────────────────┘
```

---

## סוגי קבוצות - הגדרות

### טבלת סוגי קבוצות

| סוג | מזהה | אייקון | שם | תיאור |
|-----|------|--------|-----|-------|
| משפחה | `family` | 👨‍👩‍👧 | משפחה | רשימות קניות ומזווה משותף |
| ועד בית | `building` | 🏢 | ועד בית | הצבעות ומשימות לבניין |
| ועד גן | `kindergarten` | 🧒 | ועד גן/כיתה | אירועים וגיוסים להורים |
| חברים | `friends` | 👫 | חברים | טיולים ואירועים משותפים |
| אירוע | `event` | 🎉 | אירוע | חתונה, בר מצווה, יום הולדת |
| שותפים | `roommates` | 🏠 | שותפים לדירה | ניהול דירה משותפת |
| אחר | `other` | 📋 | אחר | לכל מטרה אחרת |

### סוגי רשימות זמינים לפי קבוצה

| סוג קבוצה | 🛒 קניות | 📦 מזווה | 🗳️ הצבעה | 🎉 מי מביא | ✓ צ'קליסט | 📊 סקר |
|-----------|----------|----------|----------|-----------|-----------|--------|
| משפחה | ✅ | ✅ | ❌ | ❌ | ✅ | ❌ |
| ועד בית | ❌ | ❌ | ✅ | ✅ | ✅ | ✅ |
| ועד גן | ❌ | ❌ | ✅ | ✅ | ✅ | ✅ |
| חברים | ❌ | ❌ | ✅ | ✅ | ✅ | ✅ |
| אירוע | ❌ | ❌ | ✅ | ✅ | ✅ | ✅ |
| שותפים | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| אחר | ❌ | ❌ | ✅ | ✅ | ✅ | ✅ |

### שדות מיוחדים לפי סוג קבוצה

| סוג קבוצה | שדות נוספים |
|-----------|-------------|
| ועד בית | כתובת הבניין (אופציונלי) |
| ועד גן | שם הגן/בית ספר (אופציונלי) |
| אירוע | תאריך האירוע (אופציונלי) |
| שאר הסוגים | ללא שדות נוספים |

---

## סוגי רשימות - עיצוב ותצוגה

### סיכום סוגי הרשימות

| סוג | אייקון | צבע מזהה | שימוש עיקרי |
|-----|--------|----------|-------------|
| קניות | 🛒 | ירוק | רשימת קניות משפחתית |
| מזווה | 📦 | חום/כתום | ניהול מלאי הבית |
| הצבעה | 🗳️ | כחול | קבלת החלטות קבוצתית |
| מי מביא | 🎉 | סגול | חלוקת אחריות לאירוע |
| צ'קליסט | ✓ | אפור/ציאן | רשימת משימות |

---

### 1. רשימת קניות 🛒

#### כרטיס רשימה (בתצוגת רשימות)
```
┌─────────────────────────────────────┐
│ 🛒 רשימת סופר שבועי                 │
│    8 פריטים • עודכן לפני 2 שעות    │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ חלב, ביצים, לחם, גבינה...       │ │
│ └─────────────────────────────────┘ │
│                                     │
│         [פתח רשימה] [🛒 קנייה]     │
└─────────────────────────────────────┘
```

#### מסך הרשימה (תצוגה רגילה)
```
┌─────────────────────────────────────┐
│ ← 🛒 רשימת סופר שבועי        [⚙️] │
├─────────────────────────────────────┤
│                                     │
│ 🥛 חלב ומוצרי חלב                   │
│ ┌─────────────────────────────────┐ │
│ │ ☐ חלב 3%              2 יח'    │ │
│ │ ☐ גבינה צהובה         1 יח'    │ │
│ │ ☐ יוגורט              6 יח'    │ │
│ └─────────────────────────────────┘ │
│                                     │
│ 🥚 ביצים                            │
│ ┌─────────────────────────────────┐ │
│ │ ☐ ביצים L             1 תבנית  │ │
│ └─────────────────────────────────┘ │
│                                     │
│ 🍞 לחם ומאפים                       │
│ ┌─────────────────────────────────┐ │
│ │ ☐ לחם פרוס            1 יח'    │ │
│ │ ☐ פיתות               1 חבילה  │ │
│ └─────────────────────────────────┘ │
│                                     │
│ 📝 ללא קטגוריה                      │
│ ┌─────────────────────────────────┐ │
│ │ ☐ סבון כלים           1 יח'    │ │
│ └─────────────────────────────────┘ │
│                                     │
├─────────────────────────────────────┤
│ 8 פריטים • ~₪85                     │
├─────────────────────────────────────┤
│ [+ הוסף פריט]      [🛒 התחל קנייה] │
└─────────────────────────────────────┘
```

#### מסך הרשימה (מצב קנייה)
```
┌─────────────────────────────────────┐
│ 🛒 מצב קנייה                  [✕]  │
│ רשימת סופר שבועי                    │
├─────────────────────────────────────┤
│                                     │
│ ☐ חלב 3%                            │
│ ┌─────────────────────────────────┐ │
│ │  [-]      2 יח'      [+]       │ │
│ │          ~₪12                   │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ✅ גבינה צהובה          ← נקנה     │
│ ┌─────────────────────────────────┐ │
│ │  [-]      1 יח'      [+]   ✓   │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ⚠️ יוגורט               ← לא נקנה  │
│ ┌─────────────────────────────────┐ │
│ │  [-]      6 יח'      [+]       │ │
│ │  (לא נקנה בפעם הקודמת)          │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ☐ ביצים L                           │
│ ┌─────────────────────────────────┐ │
│ │  [-]      1 תבנית    [+]       │ │
│ └─────────────────────────────────┘ │
│                                     │
├─────────────────────────────────────┤
│ נקנו: 1/8 • ~₪12                    │
├─────────────────────────────────────┤
│         [✓ סיים קנייה]              │
└─────────────────────────────────────┘
```

#### הוספת פריט לרשימה
```
┌─────────────────────────────────────┐
│ ═══════════════                     │
│                                     │
│ הוספת פריט                          │
│                                     │
│ 🔍 חיפוש מוצר...                    │
│ ┌────────────────────────────────┐  │
│ │ חלב                            │  │
│ └────────────────────────────────┘  │
│                                     │
│ הצעות מהקטלוג:                      │
│ ┌────────────────────────────────┐  │
│ │ 🥛 חלב תנובה 3%                │  │
│ │ 🥛 חלב תנובה 1%                │  │
│ │ 🥛 חלב שוקו                    │  │
│ └────────────────────────────────┘  │
│                                     │
│ או הוסף פריט חדש:                   │
│                                     │
│ שם: [חלב 3%________________]        │
│                                     │
│ כמות:                               │
│ ┌────────────────────────────────┐  │
│ │    [-]     2     [+]           │  │
│ └────────────────────────────────┘  │
│                                     │
│ יחידה: [יח' ▼]                      │
│                                     │
│ קטגוריה: [חלב ומוצרי חלב ▼]         │
│                                     │
│ ┌────────────────────────────────┐  │
│ │          + הוסף                │  │
│ └────────────────────────────────┘  │
└─────────────────────────────────────┘
```

#### Firestore - רשימת קניות
```
/lists/{listId}
├── type: "shopping"
├── name: "רשימת סופר שבועי"
├── group_id: "family_abc" | null (אישית)
├── created_by: "user_abc"
├── created_at: timestamp
├── updated_at: timestamp
├── items_count: 8
├── estimated_price: 85
├── status: "active" | "shopping" | "completed"
└── last_shopped: timestamp | null

/lists/{listId}/items/{itemId}
├── name: "חלב 3%"
├── product_id: "prod_xyz" | null (מותאם אישית)
├── quantity: 2
├── unit: "יח'"
├── category: "dairy"
├── estimated_price: 12 | null
├── is_purchased: false
├── purchased_quantity: 0
├── not_purchased_before: false (סימון ⚠️)
├── added_by: "user_abc"
├── added_at: timestamp
└── sort_order: 1
```

---

### 2. רשימת הצבעה 🗳️

#### כרטיס רשימה (בתצוגת רשימות)
```
┌─────────────────────────────────────┐
│ 🗳️ להחליף ספק אינטרנט?              │
│    הצבעה • נסגרת ב-20/12            │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ בעד: 8  נגד: 3  נמנע: 1        │ │
│ │ ████████░░░░                    │ │
│ └─────────────────────────────────┘ │
│                                     │
│ הצבעת: ✅ בעד                       │
│                       [פתח הצבעה]  │
└─────────────────────────────────────┘
```

#### מסך הצבעה (לפני שהצביע)
```
┌─────────────────────────────────────┐
│ ← 🗳️ הצבעה                    [⚙️] │
├─────────────────────────────────────┤
│                                     │
│      ┌─────────────────────┐        │
│      │        🗳️          │        │
│      └─────────────────────┘        │
│                                     │
│         להחליף ספק אינטרנט?         │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ 📝 פרטים נוספים:                    │
│ ┌─────────────────────────────────┐ │
│ │ הספק הנוכחי יקר מדי.            │ │
│ │ יש הצעה מספק חדש בחצי מחיר.     │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ 📊 מצב ההצבעה:                      │
│                                     │
│ בעד:  ████████░░░░ 8               │
│ נגד:  ███░░░░░░░░░ 3               │
│ נמנע: █░░░░░░░░░░░ 1               │
│                                     │
│ טרם הצביעו: 2 מתוך 14               │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ 🗳️ ההצבעה שלך:                      │
│                                     │
│ ┌─────────┐ ┌─────────┐ ┌─────────┐ │
│ │  👍     │ │  👎     │ │  🤷    │ │
│ │  בעד    │ │  נגד    │ │  נמנע  │ │
│ └─────────┘ └─────────┘ └─────────┘ │
│                                     │
├─────────────────────────────────────┤
│ ⏰ נסגרת ב: 20/12/2025 בשעה 18:00   │
│    נותרו: 3 ימים 4 שעות             │
└─────────────────────────────────────┘
```

#### מסך הצבעה (אחרי שהצביע)
```
┌─────────────────────────────────────┐
│ ← 🗳️ הצבעה                    [⚙️] │
├─────────────────────────────────────┤
│                                     │
│      ┌─────────────────────┐        │
│      │        🗳️          │        │
│      └─────────────────────┘        │
│                                     │
│         להחליף ספק אינטרנט?         │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ 📊 מצב ההצבעה:                      │
│                                     │
│ בעד:  █████████░░░ 9  (64%)        │
│ נגד:  ███░░░░░░░░░ 3  (21%)        │
│ נמנע: ██░░░░░░░░░░ 2  (14%)        │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ ✅ הצבעת: בעד                       │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │         שנה הצבעה               │ │
│ └─────────────────────────────────┘ │
│                                     │
├─────────────────────────────────────┤
│ ⏰ נסגרת ב: 20/12/2025 בשעה 18:00   │
└─────────────────────────────────────┘
```

#### מסך הצבעה (הצבעה גלויה - רואים מי הצביע)
```
┌─────────────────────────────────────┐
│ ← 🗳️ הצבעה                    [⚙️] │
├─────────────────────────────────────┤
│                                     │
│         להחליף ספק אינטרנט?         │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ 👍 בעד (9):                         │
│ ┌─────────────────────────────────┐ │
│ │ [👤] [👩] [👨] [👧] [👦]         │ │
│ │ [🧑] [👴] [👵] [🧒]               │ │
│ │ יוסי, רונית, דני, מיכל...       │ │
│ └─────────────────────────────────┘ │
│                                     │
│ 👎 נגד (3):                         │
│ ┌─────────────────────────────────┐ │
│ │ [👤] [👩] [👨]                   │ │
│ │ אבי, שרה, לאה                    │ │
│ └─────────────────────────────────┘ │
│                                     │
│ 🤷 נמנע (2):                        │
│ ┌─────────────────────────────────┐ │
│ │ [👤] [👩]                        │ │
│ │ חיים, נעמי                       │ │
│ └─────────────────────────────────┘ │
│                                     │
├─────────────────────────────────────┤
│ ⏰ נסגרת ב: 20/12/2025              │
└─────────────────────────────────────┘
```

#### מסך הצבעה (הסתיימה - תוצאות)
```
┌─────────────────────────────────────┐
│ ← 🗳️ הצבעה                         │
├─────────────────────────────────────┤
│                                     │
│      ┌─────────────────────┐        │
│      │        ✅           │        │
│      │      אושר           │        │
│      └─────────────────────┘        │
│                                     │
│         להחליף ספק אינטרנט?         │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ 📊 תוצאות סופיות:                   │
│                                     │
│ ✅ בעד:  █████████░░░ 9  (64%)     │
│    נגד:  ███░░░░░░░░░ 3  (21%)     │
│    נמנע: ██░░░░░░░░░░ 2  (14%)     │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ 📌 ההחלטה: ההצעה אושרה ברוב קולות   │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ ⏰ הסתיימה ב: 20/12/2025            │
│ 👥 השתתפו: 14 מתוך 14 (100%)        │
│                                     │
└─────────────────────────────────────┘
```

#### מסך הצבעה (תיקו - הבעלים מכריע)
```
┌─────────────────────────────────────┐
│ ← 🗳️ הצבעה                         │
├─────────────────────────────────────┤
│                                     │
│      ┌─────────────────────┐        │
│      │        ⚖️          │        │
│      │       תיקו          │        │
│      └─────────────────────┘        │
│                                     │
│         להחליף ספק אינטרנט?         │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ 📊 תוצאות:                          │
│                                     │
│ בעד:  █████░░░░░ 5  (50%)          │
│ נגד:  █████░░░░░ 5  (50%)          │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ ⚠️ נוצר תיקו!                       │
│                                     │
│ כבעלים, ההכרעה בידיך:               │
│                                     │
│ ┌─────────┐ ┌─────────┐ ┌─────────┐ │
│ │ אישור   │ │ דחייה   │ │ הארכה   │ │
│ └─────────┘ └─────────┘ └─────────┘ │
│                                     │
└─────────────────────────────────────┘
```

#### יצירת הצבעה חדשה
```
┌─────────────────────────────────────┐
│ ← יצירת הצבעה חדשה                  │
├─────────────────────────────────────┤
│                                     │
│ נושא ההצבעה:                        │
│ ┌────────────────────────────────┐  │
│ │ להחליף ספק אינטרנט?            │  │
│ └────────────────────────────────┘  │
│                                     │
│ פרטים נוספים (אופציונלי):           │
│ ┌────────────────────────────────┐  │
│ │ הספק הנוכחי יקר מדי...         │  │
│ │                                │  │
│ └────────────────────────────────┘  │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ תאריך סיום:                         │
│ ┌────────────────────────────────┐  │
│ │ 📅 20/12/2025   ⏰ 18:00       │  │
│ └────────────────────────────────┘  │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ סוג הצבעה:                          │
│ ┌─────────────────────────────────┐ │
│ │ ○ גלויה - רואים מי הצביע מה     │ │
│ │ ● חשאית - רואים רק סיכום        │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ במקרה של תיקו:                      │
│ ┌─────────────────────────────────┐ │
│ │ ○ ההצעה נדחית                   │ │
│ │ ○ הארכת זמן (48 שעות)           │ │
│ │ ● הבעלים מכריע                  │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ 💡 כל חברי הקבוצה יקבלו התראה       │
│                                     │
│ ┌────────────────────────────────┐  │
│ │         צור הצבעה              │  │
│ └────────────────────────────────┘  │
└─────────────────────────────────────┘
```

#### Firestore - הצבעה
```
/groups/{groupId}/lists/{listId}
├── type: "vote"
├── title: "להחליף ספק אינטרנט?"
├── description: "הספק הנוכחי יקר מדי..."
├── created_by: "user_abc"
├── created_at: timestamp
├── ends_at: timestamp
├── is_anonymous: true | false
├── tie_breaker: "owner_decides" | "rejected" | "extend"
├── status: "active" | "ended" | "tie" | "deciding"
├── votes: {
│     "user_abc": { vote: "for", voted_at: timestamp },
│     "user_def": { vote: "against", voted_at: timestamp },
│     "user_ghi": { vote: "abstain", voted_at: timestamp }
│   }
├── results: {
│     for: 9,
│     against: 3,
│     abstain: 2,
│     total_members: 14,
│     not_voted: 0
│   }
├── final_decision: null | "approved" | "rejected"
└── decided_by: null | "majority" | "owner"
```

---

### 3. רשימת "מי מביא" 🎉

#### כרטיס רשימה (בתצוגת רשימות)
```
┌─────────────────────────────────────┐
│ 🎉 מסיבת חנוכה - מי מביא            │
│    מי מביא • 8/15 מתנדבים           │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ ████████░░░░░░░ 53%             │ │
│ │ חסרים: סופגניות, נרות, מפיות   │ │
│ └─────────────────────────────────┘ │
│                                     │
│ סימנת: סלט ירקות           [פתח]  │
└─────────────────────────────────────┘
```

#### מסך "מי מביא" (תצוגה מלאה)
```
┌─────────────────────────────────────┐
│ ← 🎉 מסיבת חנוכה             [⚙️] │
│    מי מביא                          │
├─────────────────────────────────────┤
│                                     │
│ 📅 תאריך: 25/12/2025               │
│ 📍 מיקום: גן הפרחים                 │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ 📊 התקדמות: 8/15 (53%)              │
│ ████████░░░░░░░                     │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ ⏳ חסרים (7):                       │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 🍩 סופגניות                     │ │
│ │    צריך: 3 יח'                  │ │
│ │    יש: 0/3                      │ │
│ │                   [אני מביא]    │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 🕯️ נרות חנוכה                   │ │
│ │    צריך: 2 חבילות               │ │
│ │    יש: 0/2                      │ │
│ │                   [אני מביא]    │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ ✅ יש מתנדבים (8):                  │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 🧃 מיץ ענבים                    │ │
│ │    יש: 2/2 ✓ מלא                │ │
│ │    👤 יוסי, 👩 רונית             │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 🥗 סלט ירקות                    │ │
│ │    יש: 1/2                      │ │
│ │    👤 אתה                        │ │
│ │                   [אני מביא]    │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 🍪 עוגיות                       │ │
│ │    יש: 3/3 ✓ מלא                │ │
│ │    👤 דני, 👩 מיכל, 👨 אבי       │ │
│ └─────────────────────────────────┘ │
│                                     │
├─────────────────────────────────────┤
│          [+ הוסף פריט]              │
└─────────────────────────────────────┘
```

#### פריט "מי מביא" - מצבים שונים

**פריט ריק (אין מתנדבים):**
```
┌─────────────────────────────────────┐
│ 🍩 סופגניות                         │
│    צריך: 3 יח'                      │
│                                     │
│    ░░░░░░░░░░ 0/3                   │
│                                     │
│                      [אני מביא]     │
└─────────────────────────────────────┘
```

**פריט חלקי (יש מתנדבים אבל לא מלא):**
```
┌─────────────────────────────────────┐
│ 🥗 סלט ירקות                        │
│    צריך: 2 יח'                      │
│                                     │
│    █████░░░░░ 1/2                   │
│    👤 דני                            │
│                                     │
│                      [אני מביא]     │
└─────────────────────────────────────┘
```

**פריט מלא:**
```
┌─────────────────────────────────────┐
│ 🍪 עוגיות                     ✓    │
│    צריך: 3 יח'                      │
│                                     │
│    ██████████ 3/3 מלא               │
│    👤 דני, 👩 מיכל, 👨 אבי           │
│                                     │
└─────────────────────────────────────┘
```

**הסימון שלי:**
```
┌─────────────────────────────────────┐
│ 🥗 סלט ירקות                   ⭐   │
│    צריך: 2 יח'                      │
│                                     │
│    █████░░░░░ 1/2                   │
│    👤 אתה ←                          │
│                                     │
│                      [בטל סימון]    │
└─────────────────────────────────────┘
```

#### הוספת פריט "מי מביא"
```
┌─────────────────────────────────────┐
│ ═══════════════                     │
│                                     │
│ הוספת פריט                          │
│                                     │
│ שם הפריט:                           │
│ ┌────────────────────────────────┐  │
│ │ סופגניות                       │  │
│ └────────────────────────────────┘  │
│                                     │
│ כמה צריך?                           │
│ ┌────────────────────────────────┐  │
│ │    [-]     3     [+]           │  │
│ └────────────────────────────────┘  │
│                                     │
│ יחידה (אופציונלי):                  │
│ ┌────────────────────────────────┐  │
│ │ יח' ▼                          │  │
│ └────────────────────────────────┘  │
│                                     │
│ הערות (אופציונלי):                  │
│ ┌────────────────────────────────┐  │
│ │ עדיף סופגניות עם ריבה          │  │
│ └────────────────────────────────┘  │
│                                     │
│ ┌────────────────────────────────┐  │
│ │          + הוסף                │  │
│ └────────────────────────────────┘  │
└─────────────────────────────────────┘
```

#### Firestore - מי מביא
```
/groups/{groupId}/lists/{listId}
├── type: "who_brings"
├── name: "מסיבת חנוכה - מי מביא"
├── event_date: timestamp | null
├── event_location: "גן הפרחים" | null
├── created_by: "user_abc"
├── created_at: timestamp
├── updated_at: timestamp
├── status: "active" | "completed"
├── total_needed: 15
├── total_volunteers: 8
└── progress_percent: 53

/groups/{groupId}/lists/{listId}/items/{itemId}
├── name: "סופגניות"
├── emoji: "🍩" | null
├── needed_count: 3
├── unit: "יח'"
├── notes: "עדיף סופגניות עם ריבה"
├── volunteers: [
│     {
│       user_id: "user_abc",
│       name: "יוסי",
│       avatar: "👤",
│       signed_at: timestamp
│     }
│   ]
├── is_full: false
├── added_by: "user_xyz"
├── added_at: timestamp
└── sort_order: 1
```

---

### 4. צ'קליסט ✓

#### כרטיס רשימה (בתצוגת רשימות)
```
┌─────────────────────────────────────┐
│ ✓ משימות לפני החג                   │
│    צ'קליסט • 4/10 הושלמו            │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ ████░░░░░░ 40%                  │ │
│ │ הבא: לנקות את הבית              │ │
│ └─────────────────────────────────┘ │
│                                     │
│                           [פתח]    │
└─────────────────────────────────────┘
```

#### מסך צ'קליסט (תצוגה מלאה)
```
┌─────────────────────────────────────┐
│ ← ✓ משימות לפני החג           [⚙️] │
├─────────────────────────────────────┤
│                                     │
│ 📊 התקדמות: 4/10 (40%)              │
│ ████░░░░░░                          │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ ☐ לנקות את הבית                     │
│ ┌─────────────────────────────────┐ │
│ │ □                               │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ☐ לסדר את הארון                     │
│ ┌─────────────────────────────────┐ │
│ │ □                               │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ☐ להזמין אורחים                     │
│ ┌─────────────────────────────────┐ │
│ │ □                               │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ ✅ הושלמו (4):                      │
│                                     │
│ ✓ לקנות מתנות          👤 יוסי     │
│ ┌─────────────────────────────────┐ │
│ │ ✓                               │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ✓ להכין תפריט           👩 רונית   │
│ ┌─────────────────────────────────┐ │
│ │ ✓                               │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ✓ להזמין קייטרינג       👤 יוסי    │
│ ✓ לשלוח הזמנות          👩 רונית   │
│                                     │
├─────────────────────────────────────┤
│          [+ הוסף משימה]             │
└─────────────────────────────────────┘
```

#### צ'קליסט עם תאריכי יעד (אופציונלי)
```
┌─────────────────────────────────────┐
│ ← ✓ משימות לפרויקט             [⚙️] │
├─────────────────────────────────────┤
│                                     │
│ 🔴 באיחור:                          │
│ ┌─────────────────────────────────┐ │
│ │ ☐ לסיים מצגת                    │ │
│ │    📅 עד: 10/12 (לפני 4 ימים)  │ │
│ └─────────────────────────────────┘ │
│                                     │
│ 🟡 היום:                            │
│ ┌─────────────────────────────────┐ │
│ │ ☐ לשלוח דו"ח                    │ │
│ │    📅 עד: היום                   │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ⚪ עתידי:                           │
│ ┌─────────────────────────────────┐ │
│ │ ☐ לתאם פגישה                    │ │
│ │    📅 עד: 20/12 (עוד 6 ימים)   │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ ✅ הושלמו (3):                      │
│ ✓ להכין חומרים                      │
│ ✓ לשלוח הזמנות                      │
│ ✓ להזמין חדר                        │
│                                     │
├─────────────────────────────────────┤
│          [+ הוסף משימה]             │
└─────────────────────────────────────┘
```

#### הוספת משימה לצ'קליסט
```
┌─────────────────────────────────────┐
│ ═══════════════                     │
│                                     │
│ הוספת משימה                         │
│                                     │
│ תיאור המשימה:                       │
│ ┌────────────────────────────────┐  │
│ │ לנקות את הבית                  │  │
│ └────────────────────────────────┘  │
│                                     │
│ תאריך יעד (אופציונלי):              │
│ ┌────────────────────────────────┐  │
│ │ 📅 בחר תאריך                   │  │
│ └────────────────────────────────┘  │
│                                     │
│ הערות (אופציונלי):                  │
│ ┌────────────────────────────────┐  │
│ │                                │  │
│ └────────────────────────────────┘  │
│                                     │
│ ┌────────────────────────────────┐  │
│ │          + הוסף                │  │
│ └────────────────────────────────┘  │
└─────────────────────────────────────┘
```

#### Firestore - צ'קליסט
```
/groups/{groupId}/lists/{listId}
├── type: "checklist"
├── name: "משימות לפני החג"
├── created_by: "user_abc"
├── created_at: timestamp
├── updated_at: timestamp
├── status: "active" | "completed"
├── total_items: 10
├── completed_items: 4
└── progress_percent: 40

/groups/{groupId}/lists/{listId}/items/{itemId}
├── name: "לנקות את הבית"
├── is_completed: false
├── completed_by: null | "user_abc"
├── completed_at: null | timestamp
├── due_date: null | timestamp
├── notes: null | "..."
├── added_by: "user_xyz"
├── added_at: timestamp
└── sort_order: 1
```

---

### 5. סקר (סוג חדש!) 📊

#### הסבר
סקר שונה מהצבעה - בסקר יש **מספר אפשרויות** ואפשר לבחור אחת או יותר.

#### כרטיס סקר (בתצוגת רשימות)
```
┌─────────────────────────────────────┐
│ 📊 מתי נוח לכולם לפגישה?            │
│    סקר • נסגר ב-18/12               │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 4 אפשרויות • 8 משיבים           │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ענית: ✅                   [פתח]   │
└─────────────────────────────────────┘
```

#### מסך סקר (לפני שענה)
```
┌─────────────────────────────────────┐
│ ← 📊 סקר                       [⚙️] │
├─────────────────────────────────────┤
│                                     │
│      ┌─────────────────────┐        │
│      │        📊           │        │
│      └─────────────────────┘        │
│                                     │
│       מתי נוח לכולם לפגישה?         │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ 📝 פרטים:                           │
│ ┌─────────────────────────────────┐ │
│ │ נא לסמן את כל הזמנים שנוחים     │ │
│ │ לכם להגיע.                       │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ 🗳️ בחר את התשובות שלך:             │
│    (אפשר לבחור יותר מאחת)           │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ ☐ יום שני 18:00                 │ │
│ │    ████████░░ 8 בחרו            │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ ☐ יום שלישי 19:00               │ │
│ │    ██████░░░░ 6 בחרו            │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ ☐ יום רביעי 20:00               │ │
│ │    ████░░░░░░ 4 בחרו            │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ ☐ יום חמישי 18:00               │ │
│ │    ██████████ 10 בחרו           │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌────────────────────────────────┐  │
│ │          שלח תשובות            │  │
│ └────────────────────────────────┘  │
│                                     │
├─────────────────────────────────────┤
│ ⏰ נסגר ב: 18/12/2025               │
│ 👥 ענו: 10 מתוך 14                  │
└─────────────────────────────────────┘
```

#### מסך סקר (אחרי שענה)
```
┌─────────────────────────────────────┐
│ ← 📊 סקר                       [⚙️] │
├─────────────────────────────────────┤
│                                     │
│       מתי נוח לכולם לפגישה?         │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ 📊 תוצאות:                          │
│                                     │
│ 🥇 יום חמישי 18:00        10 (71%) │
│    ██████████░░░░                   │
│    👤 יוסי, 👩 רונית, 👨 דני...     │
│                                     │
│ 🥈 יום שני 18:00           8 (57%) │
│    ████████░░░░░░                   │
│    👤 יוסי, 👩 מיכל, 👨 אבי...      │
│                                     │
│    יום שלישי 19:00         6 (43%) │
│    ██████░░░░░░░░                   │
│                                     │
│    יום רביעי 20:00         4 (29%) │
│    ████░░░░░░░░░░                   │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ ✅ התשובות שלך:                     │
│    • יום שני 18:00                  │
│    • יום חמישי 18:00                │
│                                     │
│ ┌────────────────────────────────┐  │
│ │         שנה תשובות             │  │
│ └────────────────────────────────┘  │
│                                     │
├─────────────────────────────────────┤
│ ⏰ נסגר ב: 18/12/2025               │
│ 👥 ענו: 10 מתוך 14                  │
└─────────────────────────────────────┘
```

#### יצירת סקר חדש
```
┌─────────────────────────────────────┐
│ ← יצירת סקר חדש                     │
├─────────────────────────────────────┤
│                                     │
│ שאלת הסקר:                          │
│ ┌────────────────────────────────┐  │
│ │ מתי נוח לכולם לפגישה?          │  │
│ └────────────────────────────────┘  │
│                                     │
│ פרטים נוספים (אופציונלי):           │
│ ┌────────────────────────────────┐  │
│ │ נא לסמן את כל הזמנים...        │  │
│ └────────────────────────────────┘  │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ אפשרויות:                           │
│                                     │
│ ┌────────────────────────────────┐  │
│ │ 1. יום שני 18:00          [🗑️] │  │
│ └────────────────────────────────┘  │
│ ┌────────────────────────────────┐  │
│ │ 2. יום שלישי 19:00        [🗑️] │  │
│ └────────────────────────────────┘  │
│ ┌────────────────────────────────┐  │
│ │ 3. יום רביעי 20:00        [🗑️] │  │
│ └────────────────────────────────┘  │
│ ┌────────────────────────────────┐  │
│ │ + הוסף אפשרות                  │  │
│ └────────────────────────────────┘  │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ סוג סקר:                            │
│ ┌─────────────────────────────────┐ │
│ │ ● בחירה מרובה (כמה שרוצים)      │ │
│ │ ○ בחירה יחידה (רק אחת)          │ │
│ └─────────────────────────────────┘ │
│                                     │
│ תאריך סיום:                         │
│ ┌────────────────────────────────┐  │
│ │ 📅 18/12/2025   ⏰ 18:00       │  │
│ └────────────────────────────────┘  │
│                                     │
│ ┌────────────────────────────────┐  │
│ │          צור סקר               │  │
│ └────────────────────────────────┘  │
└─────────────────────────────────────┘
```

#### Firestore - סקר
```
/groups/{groupId}/lists/{listId}
├── type: "survey"
├── title: "מתי נוח לכולם לפגישה?"
├── description: "נא לסמן את כל הזמנים..."
├── created_by: "user_abc"
├── created_at: timestamp
├── ends_at: timestamp
├── allow_multiple: true | false
├── status: "active" | "ended"
├── options: [
│     { id: "opt_1", text: "יום שני 18:00", votes: 8 },
│     { id: "opt_2", text: "יום שלישי 19:00", votes: 6 },
│     { id: "opt_3", text: "יום רביעי 20:00", votes: 4 },
│     { id: "opt_4", text: "יום חמישי 18:00", votes: 10 }
│   ]
├── responses: {
│     "user_abc": {
│       options: ["opt_1", "opt_4"],
│       responded_at: timestamp
│     },
│     "user_def": {
│       options: ["opt_4"],
│       responded_at: timestamp
│     }
│   }
├── total_responses: 10
└── total_members: 14
```

---

### סיכום סוגי רשימות

| סוג | אייקון | שימוש | קבוצות |
|-----|--------|-------|--------|
| קניות | 🛒 | רשימת קניות עם מצב קנייה | משפחה, שותפים |
| הצבעה | 🗳️ | החלטה בעד/נגד/נמנע | כל הקבוצות חוץ ממשפחה |
| מי מביא | 🎉 | חלוקת אחריות לאירוע | כל הקבוצות חוץ ממשפחה |
| צ'קליסט | ✓ | רשימת משימות | כל הקבוצות |
| סקר | 📊 | שאלה עם אפשרויות | כל הקבוצות חוץ ממשפחה |

---

## מערכת ההרשאות

### תפקידים ויכולות

| פעולה | בעלים | אדמין | עורך | צופה |
|-------|-------|-------|------|------|
| צפייה ברשימה | ✅ | ✅ | ✅ | ✅ |
| עריכת פריטים | ✅ | ✅ | ⏳ דורש אישור | ❌ |
| הוספת פריטים | ✅ | ✅ | ⏳ דורש אישור | ❌ |
| מחיקת פריטים | ✅ | ✅ | ⏳ דורש אישור | ❌ |
| סימון "אני מביא" | ✅ | ✅ (ניתן לשינוי) | ✅ (ננעל) | ❌ |
| ביטול סימון של אחרים | ✅ | ✅ | ❌ | ❌ |
| הזמנת משתמשים | ✅ | ✅ | ❌ | ❌ |
| הסרת משתמשים | ✅ | ✅ (לא אדמינים/בעלים) | ❌ | ❌ |
| שינוי הרשאות | ✅ | ❌ | ❌ | ❌ |
| מחיקת הרשימה | ✅ | ❌ | ❌ | ❌ |

### עורך - מערכת בקשות
- כל פעולה של עורך (הוספה/עריכה/מחיקה) יוצרת **בקשה**
- הבקשה מוצגת רק לעורך עצמו + בעלים/אדמינים
- עורכים אחרים וצופים לא רואים בקשות שטרם אושרו
- עיצוב מיוחד לבקשות ממתינות (למשל: רקע צהוב/כתום)

### סימון "אני מביא"
- עורך: יכול לסמן, אבל **ננעל** אחרי הסימון
- אדמין: יכול לסמן ו**לשנות** מתי שרוצה
- אדמין יכול לבטל/לערוך סימון של כל משתמש

---

## מערכת הזמנות לרשימה

### זרימת ההזמנה

```
שלב 1: בעלים/אדמין יוצר הזמנה
   ┌─────────────────────────────────────┐
   │ שם: יוסי                            │
   │ טלפון: 050-1234567                  │
   │ הרשאה: [עורך ▼]                     │
   │                          [צור קוד] │
   └─────────────────────────────────────┘
              ↓
   נוצר קוד אישי: ABC123
   (נשמר ב-Firebase עם הטלפון + רמת ההרשאה)

שלב 2: שליחה ידנית
   בעלים שולח ליוסי בווטסאפ:
   "הורד את MemoZap, הקוד שלך: ABC123"

שלב 3: יוסי נרשם לאפליקציה
   - חובה להזין טלפון (050-1234567)
   - הטלפון חייב להתאים!

שלב 4: יוסי מזין את הקוד
   הגדרות → "הזן קוד הזמנה" → ABC123
              ↓
   המערכת בודקת:
   ✓ קוד קיים?
   ✓ טלפון תואם?
   ✓ הקוד לא פג תוקף?
              ↓
   יוסי מצטרף לרשימה כעורך!
```

### מבנה הזמנה ב-Firestore

```
/list_invites/{inviteId}
├── code: "ABC123"
├── list_id: "list_xyz"
├── phone: "0501234567" (מנורמל)
├── role: "editor"
├── created_by: "user_abc"
├── created_at: timestamp
├── expires_at: timestamp (7 ימים)
├── status: "pending" | "used" | "expired"
└── used_by: null | "user_def"
```

---

## מזווה (Inventory)

### מטרת המזווה
- לדעת מה יש בבית (מלאי)
- לקבל התראות/הצעות כשנגמר משהו
- להוסיף אוטומטית לרשימת קניות כשמלאי נמוך
- לזהות דפוסי קניות ולהציע מוצרים קבועים

---

### מסך מזווה ראשי

```
┌─────────────────────────────────────┐
│ 📦 המזווה שלנו              [⚙️] [+]│
│    משפחת כהן                        │
├─────────────────────────────────────┤
│                                     │
│ 🔍 חיפוש מוצר...                    │
│ ┌─────────────────────────────────┐ │
│ │                                 │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 🏠 הכל │ 🧊 מקרר │ ❄️ הקפאה │ 🗄️ מזווה │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ═══════════════════════════════════ │
│                                     │
│ ⚠️ מלאי נמוך (3)                    │
│ ┌─────────────────────────────────┐ │
│ │ 🥛 חלב 3%              1 יח'   │ │
│ │    מקרר • מינימום: 2           │ │
│ │              [-]  1  [+] [🛒]  │ │
│ ├─────────────────────────────────┤ │
│ │ 🥚 ביצים L             1 תבנית │ │
│ │    מקרר • מינימום: 2           │ │
│ │              [-]  1  [+] [🛒]  │ │
│ ├─────────────────────────────────┤ │
│ │ 🧻 נייר טואלט          2 יח'   │ │
│ │    מזווה • מינימום: 4          │ │
│ │              [-]  2  [+] [🛒]  │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ═══════════════════════════════════ │
│                                     │
│ 🥛 מוצרי חלב (5)                    │
│ ┌─────────────────────────────────┐ │
│ │ 🧀 גבינה צהובה          2 יח'  │ │
│ │    מקרר                         │ │
│ │              [-]  2  [+]       │ │
│ ├─────────────────────────────────┤ │
│ │ 🥛 שמנת מתוקה          1 יח'   │ │
│ │    מקרר                         │ │
│ │              [-]  1  [+]       │ │
│ ├─────────────────────────────────┤ │
│ │ 🧈 חמאה                 1 יח'   │ │
│ │    מקרר                         │ │
│ │              [-]  1  [+]       │ │
│ └─────────────────────────────────┘ │
│                                     │
│ 🥖 מאפים (3)                        │
│ ┌─────────────────────────────────┐ │
│ │ 🍞 לחם אחיד             1 יח'  │ │
│ │    משטח עבודה                   │ │
│ │              [-]  1  [+]       │ │
│ ├─────────────────────────────────┤ │
│ │ 🥯 פיתות               1 שקית  │ │
│ │    הקפאה                        │ │
│ │              [-]  1  [+]       │ │
│ └─────────────────────────────────┘ │
│                                     │
│ 🥫 שימורים (4)                      │
│   ▸ לחץ להרחבה                      │
│                                     │
│ 🧴 ניקיון (6)                       │
│   ▸ לחץ להרחבה                      │
│                                     │
│                                     │
└─────────────────────────────────────┘
```

---

### סינון לפי מיקום

```
┌─────────────────────────────────────┐
│ 🏠 הכל │ [🧊 מקרר] │ ❄️ הקפאה │ 🗄️ מזווה │
└─────────────────────────────────────┘
          ↓ (נבחר מקרר)

┌─────────────────────────────────────┐
│ 📦 המזווה שלנו              [⚙️] [+]│
│    🧊 מקרר                          │
├─────────────────────────────────────┤
│                                     │
│ 📊 12 פריטים במקרר                  │
│                                     │
│ ═══════════════════════════════════ │
│                                     │
│ 🥛 מוצרי חלב (5)                    │
│ ┌─────────────────────────────────┐ │
│ │ 🥛 חלב 3%         ⚠️   1 יח'   │ │
│ │              [-]  1  [+] [🛒]  │ │
│ ├─────────────────────────────────┤ │
│ │ 🧀 גבינה צהובה          2 יח'  │ │
│ │              [-]  2  [+]       │ │
│ ├─────────────────────────────────┤ │
│ │ ...                             │ │
│ └─────────────────────────────────┘ │
│                                     │
│ 🥚 ביצים ובשר (4)                   │
│ ┌─────────────────────────────────┐ │
│ │ 🥚 ביצים L        ⚠️   1 תבנית │ │
│ │              [-]  1  [+] [🛒]  │ │
│ ├─────────────────────────────────┤ │
│ │ 🍗 חזה עוף              500 גר │ │
│ │              [-]  1  [+]       │ │
│ └─────────────────────────────────┘ │
│                                     │
│ 🥬 ירקות ופירות (3)                 │
│   ▸ לחץ להרחבה                      │
│                                     │
└─────────────────────────────────────┘
```

---

### הוספת פריט למזווה

#### לחיצה על [+]

```
┌─────────────────────────────────────┐
│                                     │
│         📦 הוספת פריט למזווה         │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ 🔍 חיפוש מוצר או הוספה ידנית        │
│ ┌─────────────────────────────────┐ │
│ │ חלב                             │ │
│ └─────────────────────────────────┘ │
│                                     │
│ תוצאות:                             │
│ ┌─────────────────────────────────┐ │
│ │ 🥛 חלב תנובה 3%                 │ │
│ ├─────────────────────────────────┤ │
│ │ 🥛 חלב יטבתה 1%                 │ │
│ ├─────────────────────────────────┤ │
│ │ 🥛 חלב שוקו                     │ │
│ ├─────────────────────────────────┤ │
│ │ ➕ הוסף "חלב" כפריט חדש         │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ 📷 [סרוק ברקוד]                     │
│     (בקרוב)                         │
│                                     │
└─────────────────────────────────────┘
```

#### בחירת מוצר מהרשימה / הוספה ידנית

```
┌─────────────────────────────────────┐
│ ← הוספת פריט                        │
├─────────────────────────────────────┤
│                                     │
│ 🥛 חלב תנובה 3%                     │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ כמות:                               │
│ ┌─────────────────────────────────┐ │
│ │         [-]    2    [+]         │ │
│ └─────────────────────────────────┘ │
│                                     │
│ יחידה:                              │
│ ┌─────────────────────────────────┐ │
│ │ יח'  │  ק"ג  │  ליטר  │  גרם   │ │
│ │ [●]     ○       ○        ○     │ │
│ └─────────────────────────────────┘ │
│                                     │
│ מיקום:                              │
│ ┌─────────────────────────────────┐ │
│ │ 🧊 מקרר                      ▼ │ │
│ └─────────────────────────────────┘ │
│                                     │
│ התראה כשנשאר:                       │
│ ┌─────────────────────────────────┐ │
│ │         [-]    1    [+]         │ │
│ └─────────────────────────────────┘ │
│                                     │
│ תאריך תפוגה (אופציונלי):            │
│ ┌─────────────────────────────────┐ │
│ │ 📅 בחר תאריך                    │ │
│ └─────────────────────────────────┘ │
│                                     │
│ הערות:                              │
│ ┌─────────────────────────────────┐ │
│ │                                 │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │         הוסף למזווה             │ │
│ └─────────────────────────────────┘ │
│                                     │
└─────────────────────────────────────┘
```

---

### עריכת פריט קיים

#### לחיצה ארוכה / Swipe על פריט

```
┌─────────────────────────────────────┐
│ 🥛 חלב תנובה 3%                     │
├─────────────────────────────────────┤
│                                     │
│ [✏️ עריכה]  [🗑️ מחיקה]  [🛒 לרשימה] │
│                                     │
└─────────────────────────────────────┘
```

#### מסך עריכה

```
┌─────────────────────────────────────┐
│ ← עריכת פריט                        │
├─────────────────────────────────────┤
│                                     │
│ שם המוצר:                           │
│ ┌─────────────────────────────────┐ │
│ │ חלב תנובה 3%                    │ │
│ └─────────────────────────────────┘ │
│                                     │
│ כמות נוכחית:                        │
│ ┌─────────────────────────────────┐ │
│ │         [-]    2    [+]         │ │
│ └─────────────────────────────────┘ │
│                                     │
│ יחידה:                              │
│ ┌─────────────────────────────────┐ │
│ │ יח'  │  ק"ג  │  ליטר  │  גרם   │ │
│ │ [●]     ○       ○        ○     │ │
│ └─────────────────────────────────┘ │
│                                     │
│ מיקום:                              │
│ ┌─────────────────────────────────┐ │
│ │ 🧊 מקרר                      ▼ │ │
│ └─────────────────────────────────┘ │
│                                     │
│ התראה כשנשאר:                       │
│ ┌─────────────────────────────────┐ │
│ │         [-]    1    [+]         │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ☐ מוצר קבוע (יתווסף לרשימות חדשות) │
│                                     │
│ תאריך תפוגה:                        │
│ ┌─────────────────────────────────┐ │
│ │ 📅 20/12/2025                   │ │
│ └─────────────────────────────────┘ │
│                                     │
│ הערות:                              │
│ ┌─────────────────────────────────┐ │
│ │ לקנות רק מסניף הגדול            │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ 📊 סטטיסטיקה:                       │
│    נקנה 12 פעמים                    │
│    קנייה אחרונה: 10/12/2025         │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │           שמור שינויים          │ │
│ └─────────────────────────────────┘ │
│                                     │
└─────────────────────────────────────┘
```

---

### מזווה ריק (משתמש חדש)

```
┌─────────────────────────────────────┐
│ 📦 המזווה שלי               [⚙️] [+]│
├─────────────────────────────────────┤
│                                     │
│                                     │
│                                     │
│         ┌───────────────┐           │
│         │      📦       │           │
│         │    (ריק)      │           │
│         └───────────────┘           │
│                                     │
│       המזווה שלך ריק!               │
│                                     │
│   הוסף מוצרים כדי לעקוב אחרי        │
│   מה יש לך בבית ולקבל התראות        │
│   כשמשהו נגמר.                      │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │       + הוסף מוצר ראשון         │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ 💡 טיפ: אחרי קנייה, המוצרים שקנית   │
│    יתווספו אוטומטית למזווה!         │
│                                     │
│                                     │
└─────────────────────────────────────┘
```

---

### התראת מלאי נמוך

#### Push Notification (בעתיד)

```
┌─────────────────────────────────────┐
│ 📦 MemoZap                          │
│                                     │
│ 🔔 3 מוצרים במלאי נמוך!             │
│    חלב, ביצים, נייר טואלט           │
│                                     │
│           [פתח מזווה]               │
└─────────────────────────────────────┘
```

#### In-App Dialog

```
┌─────────────────────────────────────┐
│                                     │
│         ⚠️ מלאי נמוך                │
│                                     │
│   3 מוצרים צריכים חידוש:            │
│                                     │
│   • 🥛 חלב 3% (נשאר: 1)             │
│   • 🥚 ביצים (נשאר: 1 תבנית)        │
│   • 🧻 נייר טואלט (נשאר: 2)         │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ ☑️ בחר הכל                          │
│                                     │
│ ┌────────────────┐ ┌──────────────┐ │
│ │   אחר כך       │ │ הוסף לרשימה  │ │
│ └────────────────┘ └──────────────┘ │
│                                     │
└─────────────────────────────────────┘
```

---

### הוספה מהירה לרשימת קניות

#### לחיצה על [🛒] ליד פריט במלאי נמוך

```
┌─────────────────────────────────────┐
│                                     │
│      🛒 הוספה לרשימת קניות          │
│                                     │
│   🥛 חלב 3%                         │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ כמות:                               │
│ ┌─────────────────────────────────┐ │
│ │         [-]    2    [+]         │ │
│ └─────────────────────────────────┘ │
│                                     │
│ לאיזו רשימה?                        │
│ ┌─────────────────────────────────┐ │
│ │ ○ רשימת סופר שבועי              │ │
│ │ ○ קניות לשבת                    │ │
│ │ ○ + צור רשימה חדשה              │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │           הוסף לרשימה           │ │
│ └─────────────────────────────────┘ │
│                                     │
└─────────────────────────────────────┘
```

---

### מוצרים קבועים (Recurring)

#### תצוגה במזווה

```
פריט עם ⭐ = מוצר קבוע

┌─────────────────────────────────────┐
│ ⭐🥛 חלב 3%               2 יח'    │
│    מקרר • מוצר קבוע               │
│              [-]  2  [+]          │
└─────────────────────────────────────┘
```

#### Dialog הפיכה למוצר קבוע

```
┌─────────────────────────────────────┐
│                                     │
│         ⭐ מוצר קבוע?               │
│                                     │
│   שמנו לב שקנית חלב 3%             │
│   6 פעמים בחודש האחרון!            │
│                                     │
│   להפוך למוצר קבוע?                 │
│   (יתווסף אוטומטית לרשימות חדשות)   │
│                                     │
│ ┌────────────────┐ ┌──────────────┐ │
│ │  לא, תודה      │ │   כן, הפוך   │ │
│ └────────────────┘ └──────────────┘ │
│                                     │
│ ☐ אל תשאל אותי שוב על מוצר זה      │
│                                     │
└─────────────────────────────────────┘
```

---

### פריטים עם תאריך תפוגה

#### תצוגה במזווה

```
פריטים קרובים לתפוגה מוצגים עם אזהרה:

┌─────────────────────────────────────┐
│ 🥛 יוגורט                  3 יח'   │
│    מקרר • ⏰ פג ב-2 ימים!          │ ← אדום
│              [-]  3  [+]          │
└─────────────────────────────────────┘

┌─────────────────────────────────────┐
│ 🧀 גבינה לבנה             1 יח'    │
│    מקרר • ⏰ פג בעוד שבוע          │ ← כתום
│              [-]  1  [+]          │
└─────────────────────────────────────┘
```

#### סינון לפי תפוגה

```
┌─────────────────────────────────────┐
│ 📦 המזווה שלנו         [סנן ▼] [+] │
├─────────────────────────────────────┤
│                                     │
│ סינון:                              │
│ ┌─────────────────────────────────┐ │
│ │ ○ הכל                           │ │
│ │ ○ מלאי נמוך                     │ │
│ │ ● פג תוקף בקרוב                 │ │ ← נבחר
│ │ ○ מוצרים קבועים                 │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ═══════════════════════════════════ │
│                                     │
│ ⏰ פג תוקף בקרוב (3)                │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 🥛 יוגורט         ⏰ עוד 2 ימים │ │
│ │    3 יח' • מקרר                 │ │
│ ├─────────────────────────────────┤ │
│ │ 🥛 שמנת חמוצה     ⏰ עוד 4 ימים │ │
│ │    1 יח' • מקרר                 │ │
│ ├─────────────────────────────────┤ │
│ │ 🧀 גבינה לבנה     ⏰ עוד 7 ימים │ │
│ │    1 יח' • מקרר                 │ │
│ └─────────────────────────────────┘ │
│                                     │
└─────────────────────────────────────┘
```

---

### הגדרות מזווה (גישה מהירה)

#### לחיצה על [⚙️] במזווה

```
┌─────────────────────────────────────┐
│                                     │
│         ⚙️ הגדרות מזווה             │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ התראות מלאי נמוך            [●]    │
│                                     │
│ התראות תפוגה                [●]    │
│ (התראה X ימים לפני)                 │
│ ┌─────────────────────────────────┐ │
│ │         [-]    3    [+]         │ │
│ └─────────────────────────────────┘ │
│                                     │
│ הוסף למזווה אחרי קנייה      [●]    │
│ (אוטומטי)                           │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ מיקומי אחסון:                       │
│ ┌─────────────────────────────────┐ │
│ │ 🧊 מקרר                     ✓   │ │
│ │ ❄️ הקפאה                    ✓   │ │
│ │ 🗄️ מזווה                    ✓   │ │
│ │ 🍳 משטח עבודה               ✓   │ │
│ │ + הוסף מיקום מותאם אישית        │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │              סגור               │ │
│ └─────────────────────────────────┘ │
│                                     │
└─────────────────────────────────────┘
```

---

### מבנה Firestore - מזווה

```
משתמש בודד:
/users/{userId}/inventory/{itemId}

משפחה:
/groups/{groupId}/inventory/{itemId}

שדות פריט:
├── product_id: "prod_xyz" | null (מותאם אישית)
├── product_name: "חלב תנובה 3%"
├── emoji: "🥛"
├── category: "dairy" | "bakery" | "meat" | "produce" | "frozen" | "canned" | "cleaning" | "other"
├── location: "refrigerator" | "freezer" | "pantry" | "countertop" | "other"
├── quantity: 2
├── unit: "יח'" | "ק\"ג" | "ליטר" | "גרם" | "שקית" | "תבנית"
├── min_quantity: 1
├── expiry_date: timestamp | null
├── notes: "..." | null
├── is_recurring: false
├── last_purchased: timestamp
├── purchase_count: 12
├── added_by: "user_abc"
├── created_at: timestamp
└── updated_at: timestamp
```

---

### קטגוריות מזווה

| קטגוריה | מזהה | אייקון | דוגמאות |
|---------|------|--------|---------|
| מוצרי חלב | dairy | 🥛 | חלב, גבינה, יוגורט |
| מאפים | bakery | 🥖 | לחם, חלות, פיתות |
| בשר ודגים | meat | 🥩 | עוף, בקר, דג |
| ירקות ופירות | produce | 🥬 | עגבניות, תפוחים |
| קפואים | frozen | ❄️ | שניצל, ירקות קפואים |
| שימורים | canned | 🥫 | טונה, תירס, רסק |
| ניקיון | cleaning | 🧴 | סבון, אקונומיקה |
| אחר | other | 📦 | כל השאר |

### מיקומי אחסון

| מיקום | מזהה | אייקון |
|-------|------|--------|
| מקרר | refrigerator | 🧊 |
| הקפאה | freezer | ❄️ |
| מזווה | pantry | 🗄️ |
| משטח עבודה | countertop | 🍳 |
| אחר | other | 📦 |

---

### הצטרפות למשפחה - טיפול במזווה

```
כשמשתמש מצטרף למשפחה:

┌─────────────────────────────────────┐
│                                     │
│      ⚠️ יש לך מזווה אישי            │
│                                     │
│   נמצאו 15 פריטים במזווה האישי שלך. │
│                                     │
│   בהצטרפות למשפחה תעבור להשתמש      │
│   במזווה המשפחתי המשותף.            │
│                                     │
│   מה יקרה למזווה האישי?             │
│                                     │
│   ○ מחק את המזווה האישי             │
│   ○ העבר פריטים למזווה המשפחתי      │
│     (יתווספו לקיימים)               │
│                                     │
│ ┌────────────────┐ ┌──────────────┐ │
│ │     ביטול      │ │    המשך      │ │
│ └────────────────┘ └──────────────┘ │
│                                     │
└─────────────────────────────────────┘
```

---

## מצב קנייה (Shopping Mode)

> **הבהרה חשובה:** מצב קנייה הוא **אישי** ולא קשור ל"אני מביא".
> - "אני מביא" = תיאום מראש ברשימה משותפת (מי קונה מה)
> - מצב קנייה = המשתמש בחנות מסמן מה קנה בפועל

---

### רשימת קניות (לפני מצב קנייה)

```
┌─────────────────────────────────────┐
│ ← 🛒 רשימת סופר שבועי         [⚙️] │
├─────────────────────────────────────┤
│                                     │
│ 📊 8 פריטים • עודכן לפני 2 דקות     │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ 🥛 מוצרי חלב (3)                    │
│ ┌─────────────────────────────────┐ │
│ │ ☐ חלב 3%                    1  │ │
│ │ ☐ גבינה צהובה               1  │ │
│ │ ☐ יוגורט                    4  │ │
│ └─────────────────────────────────┘ │
│                                     │
│ 🥖 מאפים (2)                        │
│ ┌─────────────────────────────────┐ │
│ │ ☐ לחם אחיד                  1  │ │
│ │ ☐ חלות לשבת                 2  │ │
│ └─────────────────────────────────┘ │
│                                     │
│ 🥚 ביצים ובשר (2)                   │
│ ┌─────────────────────────────────┐ │
│ │ ⚠️ ביצים L              2 תבניות│ │
│ │   └─ לא נקנה בפעם הקודמת        │ │
│ │ ☐ חזה עוף                 500 גר│ │
│ └─────────────────────────────────┘ │
│                                     │
│ 🧴 ניקיון (1)                       │
│ ┌─────────────────────────────────┐ │
│ │ ☐ סבון כלים                 1  │ │
│ └─────────────────────────────────┘ │
│                                     │
├─────────────────────────────────────┤
│                                     │
│ ┌─────────────────────────────────┐ │
│ │      🛒 התחל קנייה              │ │
│ └─────────────────────────────────┘ │
│                                     │
│         [+ הוסף פריט]               │
│                                     │
└─────────────────────────────────────┘
```

---

### כניסה למצב קנייה

#### לחיצה על "התחל קנייה"

```
┌─────────────────────────────────────┐
│                                     │
│         🛒 מצב קנייה                │
│                                     │
│   מוכן? הולכים לסופר!               │
│                                     │
│   בחר חנות (אופציונלי):             │
│   ┌─────────────────────────────┐   │
│   │ 🏪 שופרסל               ▼  │   │
│   └─────────────────────────────┘   │
│                                     │
│   ┌────────────────┐ ┌────────────┐ │
│   │     ביטול      │ │ התחל קנייה │ │
│   └────────────────┘ └────────────┘ │
│                                     │
└─────────────────────────────────────┘
```

**הערות:**
- בחירת חנות = לשמירה בהיסטוריה (לא חובה)
- **כל משתמש נכנס למצב קנייה בנפרד** (גם ברשימה משותפת)
- אם משתמש אחר במצב קנייה → הודעה: "יוסי כרגע בקנייה"

---

### מסך מצב קנייה (Shopping Mode)

```
┌─────────────────────────────────────┐
│ 🛒 מצב קנייה              [יציאה ❌]│
│    רשימת סופר שבועי                 │
├─────────────────────────────────────┤
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ ✓ 2/8 פריטים      💰 ~45 ₪     │ │
│ │ ████░░░░░░░░░░░░ 25%            │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ═══════════════════════════════════ │
│                                     │
│ 📍 לקנות:                           │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ ☐  🥛 חלב 3%                    │ │
│ │     1 יח' • ~8 ₪                │ │
│ │                      [-] 1 [+]  │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ ☐  🧀 גבינה צהובה               │ │
│ │     1 יח' • ~25 ₪               │ │
│ │                      [-] 1 [+]  │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ ⚠️ 🥚 ביצים L                   │ │
│ │     2 תבניות • ~30 ₪            │ │
│ │     לא נקנה בפעם הקודמת!        │ │
│ │                      [-] 2 [+]  │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ... (עוד 3 פריטים)                  │
│                                     │
│ ═══════════════════════════════════ │
│                                     │
│ ✅ נקנו (2):                        │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ ✓  🍞 לחם אחיד           8 ₪   │ │
│ │     1 יח'                [בטל]  │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ ✓  🧴 סבון כלים          12 ₪  │ │
│ │     1 יח'                [בטל]  │ │
│ └─────────────────────────────────┘ │
│                                     │
├─────────────────────────────────────┤
│                                     │
│ ┌─────────────────────────────────┐ │
│ │    🏁 סיים קנייה (2 פריטים)     │ │
│ └─────────────────────────────────┘ │
│                                     │
└─────────────────────────────────────┘
```

---

### פעולות במצב קנייה

#### סימון פריט כ"נקנה"

```
לחיצה על פריט:
┌─────────────────────────────────────┐
│ ☐  🥛 חלב 3%                        │
│     1 יח' • ~8 ₪                    │
│                        [-] 1 [+]    │
└─────────────────────────────────────┘
            │
            │ (לחיצה / Tap)
            ▼
┌─────────────────────────────────────┐
│ ✓  🥛 חלב 3%              ✅ 8 ₪   │ ← רקע ירוק בהיר
│     1 יח'                  [בטל]   │
└─────────────────────────────────────┘
            │
            │ (עובר לאזור "נקנו")
            ▼
```

#### שינוי כמות לפני סימון

```
אם קניתי 2 במקום 1:

┌─────────────────────────────────────┐
│ ☐  🥛 חלב 3%                        │
│     1 יח' • ~8 ₪                    │
│                        [-] 1 [+]    │
└─────────────────────────────────────┘
                             │
                             │ לחיצה על [+]
                             ▼
┌─────────────────────────────────────┐
│ ☐  🥛 חלב 3%                        │
│     2 יח' • ~16 ₪      (מקורי: 1)  │ ← מראה את השינוי
│                        [-] 2 [+]    │
└─────────────────────────────────────┘
```

#### ביטול סימון

```
┌─────────────────────────────────────┐
│ ✓  🍞 לחם אחיד             8 ₪     │
│     1 יח'                  [בטל]   │
└─────────────────────────────────────┘
                              │
                              │ לחיצה על [בטל]
                              ▼
פריט חוזר לאזור "לקנות"
```

---

### סיום קנייה

#### לחיצה על "סיים קנייה"

```
┌─────────────────────────────────────┐
│                                     │
│         🎉 סיום קנייה               │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ ✅ נקנו: 5 פריטים                   │
│    סה"כ: ~85 ₪                      │
│                                     │
│ ❌ לא נקנו: 3 פריטים                │
│    • ביצים L (2)                    │
│    • חזה עוף (500 גר)               │
│    • יוגורט (4)                     │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ מה לעשות עם הפריטים שלא נקנו?       │
│                                     │
│ ○ השאר ברשימה (ברירת מחדל)          │
│ ○ מחק מהרשימה                       │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ ☐ הוסף פריטים שנקנו למזווה          │
│   (מומלץ ✓)                         │
│                                     │
│ ┌────────────────┐ ┌──────────────┐ │
│ │     ביטול      │ │  סיים ושמור  │ │
│ └────────────────┘ └──────────────┘ │
│                                     │
└─────────────────────────────────────┘
```

#### מה קורה בלחיצה על "סיים ושמור"

```
1. פריטים שסומנו ✓:
   ├── נמחקים מהרשימה
   ├── מתווספים למזווה (אם נבחר)
   └── נשמרים בהיסטוריה (קבלה)

2. פריטים שלא סומנו:
   ├── נשארים ברשימה (אם נבחר "השאר")
   ├── מקבלים סימון ⚠️ "לא נקנה"
   └── או נמחקים (אם נבחר "מחק")

3. נוצרת "קבלה" בהיסטוריה:
   ├── תאריך ושעה
   ├── חנות (אם נבחרה)
   ├── רשימת פריטים שנקנו + כמויות + מחירים
   └── סה"כ משוער
```

---

### יציאה מאמצע קנייה

#### לחיצה על "יציאה ❌"

```
┌─────────────────────────────────────┐
│                                     │
│         ⚠️ יציאה מקנייה?            │
│                                     │
│   סימנת 2 פריטים כנקנו.             │
│   מה תרצה לעשות?                    │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 💾 שמור ויצא                    │ │
│ │    הפריטים שסימנת יישמרו        │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 🗑️ בטל הכל ויצא                 │ │
│ │    חזרה למצב לפני הקנייה        │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ ← המשך בקנייה                   │ │
│ └─────────────────────────────────┘ │
│                                     │
└─────────────────────────────────────┘
```

---

### הודעה על קנייה מקבילה

```
אם שני אנשים נכנסים לקנייה באותה רשימה:

┌─────────────────────────────────────┐
│                                     │
│         👥 קנייה משותפת             │
│                                     │
│   רונית גם נמצאת בקנייה עכשיו!      │
│                                     │
│   הפריטים שהיא תסמן יעודכנו         │
│   בזמן אמת.                         │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │           הבנתי                 │ │
│ └─────────────────────────────────┘ │
│                                     │
└─────────────────────────────────────┘
```

**בזמן קנייה מקבילה:**
- פריטים שהיא סימנה מופיעים עם תגית: "✓ נקנה ע"י רונית"
- הפריט נשאר גלוי אבל לא ניתן לסמן אותו שוב

---

### מצבי פריט במצב קנייה

| מצב | סימון | צבע | משמעות |
|-----|-------|-----|--------|
| לקנות | ☐ | לבן | טרם נקנה |
| לקנות + אזהרה | ⚠️ | צהוב בהיר | לא נקנה בפעם הקודמת |
| נקנה | ✓ | ירוק בהיר | נוסף לעגלה |
| נקנה ע"י אחר | ✓👤 | ירוק + אפור | מישהו אחר קנה |
| כמות שונה | ☐ (מקורי: X) | כחול בהיר | שינוי כמות |

---

### Firestore - מצב קנייה

```
/groups/{groupId}/lists/{listId}/shopping_sessions/{sessionId}
├── user_id: "user_abc"
├── user_name: "יוני"
├── started_at: timestamp
├── ended_at: null | timestamp
├── status: "active" | "completed" | "cancelled"
├── store: null | "שופרסל"
├── items_purchased: [
│     {
│       item_id: "item_xyz",
│       name: "חלב 3%",
│       original_quantity: 1,
│       purchased_quantity: 2,
│       price: 16
│     }
│   ]
├── items_skipped: ["item_abc", "item_def"]
└── total_estimated: 85
```

---

## היסטוריה וקבלות

### מה נשמר

כל פעם שלוחצים "סיים קנייה" נוצרת קבלה:

```
/users/{userId}/receipts/{receiptId}
או
/households/{householdId}/receipts/{receiptId}

├── list_id: "list_xyz"
├── list_name: "סופר שבועי"
├── completed_at: timestamp
├── completed_by: "user_abc"
├── purchased_items: [
│   { name: "חלב", quantity: 2, category: "dairy" },
│   { name: "ביצים", quantity: 1, category: "dairy" },
│   ...
│ ]
├── skipped_items: [
│   { name: "גבינה", quantity: 1, reason: "לא היה במלאי" },
│   ...
│ ]
└── total_items: 15
```

### תצוגת היסטוריה

```
┌─────────────────────────────────────┐
│ 📋 היסטוריית קניות                  │
├─────────────────────────────────────┤
│                                     │
│ 📅 14/12/2025 - סופר שבועי          │
│    12 פריטים נקנו, 2 לא נקנו       │
│                                     │
│ 📅 07/12/2025 - סופר שבועי          │
│    15 פריטים נקנו                   │
│                                     │
│ 📅 01/12/2025 - בית מרקחת           │
│    3 פריטים נקנו                    │
│                                     │
└─────────────────────────────────────┘
```

### שימוש עתידי

הקבלות ישמשו לניתוח דפוסי קניות:
- זיהוי מוצרים קבועים
- תדירות קנייה
- (בעתיד) מחירים וסטטיסטיקות הוצאות

---

## התראות (In-App)

### סוגי התראות

| אירוע | מקבל ההתראה |
|-------|-------------|
| הוזמנת לרשימה | המוזמן |
| עורך מבקש להוסיף פריט | בעלים + אדמינים |
| עורך מבקש לערוך פריט | בעלים + אדמינים |
| עורך מבקש למחוק פריט | בעלים + אדמינים |
| בקשה אושרה | העורך המבקש |
| בקשה נדחתה | העורך המבקש |
| מישהו סימן "אני מביא" | בעלים + אדמינים |

### הערות
- התראות **רק בתוך האפליקציה** (לא Push Notifications)
- מבנה קיים: `/users/{userId}/notifications/`

---

## מערכת הרשמה והתחברות

### סקירה כללית

```
זרימת כניסה לאפליקציה:

┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│   Splash    │────▶│  Onboarding │────▶│   Login/    │
│   Screen    │     │  (פעם ראשונה)│     │  Register   │
└─────────────┘     └─────────────┘     └─────────────┘
                            │                   │
                            │ (ראו כבר)          │ (הצלחה)
                            ▼                   ▼
                    ┌─────────────┐     ┌─────────────┐
                    │   Login/    │────▶│    Home     │
                    │  Register   │     │  Dashboard  │
                    └─────────────┘     └─────────────┘
```

---

### מסך Splash (2-3 שניות)

```
┌─────────────────────────────────────┐
│                                     │
│                                     │
│                                     │
│           ┌───────────┐             │
│           │   🛒📝    │             │
│           │  MemoZap  │             │
│           └───────────┘             │
│                                     │
│           ═══════════               │
│           (loading bar)             │
│                                     │
│                                     │
│                                     │
└─────────────────────────────────────┘
```

**מה קורה מאחורי הקלעים:**
1. בדיקת Firebase Auth - האם יש משתמש מחובר?
2. אם **כן** → ישירות ל-Home Dashboard
3. אם **לא** → בדיקת SharedPreferences: `seen_onboarding`
   - אם **false/null** → Onboarding
   - אם **true** → Login Screen

---

### מסכי Onboarding (3 מסכים)

#### מסך 1 - ברוכים הבאים

```
┌─────────────────────────────────────┐
│                                     │
│           ┌───────────┐             │
│           │   🛒📝    │             │
│           └───────────┘             │
│                                     │
│      ברוכים הבאים ל-MemoZap!        │
│                                     │
│  ┌─────────────────────────────────┐│
│  │                                 ││
│  │     🎨 [איור של רשימת קניות     ││
│  │         עם פתקים צבעוניים]      ││
│  │                                 ││
│  └─────────────────────────────────┘│
│                                     │
│    נהל את רשימות הקניות שלך         │
│    בצורה חכמה ומהנה!                │
│                                     │
│         ● ○ ○                       │
│                                     │
│        [המשך ←]                     │
│                                     │
└─────────────────────────────────────┘
```

#### מסך 2 - קבוצות ושיתוף

```
┌─────────────────────────────────────┐
│                                     │
│      שיתוף פעולה עם המשפחה          │
│                                     │
│  ┌─────────────────────────────────┐│
│  │                                 ││
│  │    🎨 [איור של משפחה            ││
│  │        משתפת רשימה]             ││
│  │                                 ││
│  └─────────────────────────────────┘│
│                                     │
│    צור קבוצות משפחה, ועד בית,       │
│    או חברים - ונהלו רשימות יחד!     │
│                                     │
│    • רשימות קניות משותפות           │
│    • מזווה משפחתי                   │
│    • הצבעות וסקרים                  │
│                                     │
│         ○ ● ○                       │
│                                     │
│   [← חזרה]        [המשך ←]          │
│                                     │
└─────────────────────────────────────┘
```

#### מסך 3 - בואו נתחיל!

```
┌─────────────────────────────────────┐
│                                     │
│         הכל מוכן!                   │
│                                     │
│  ┌─────────────────────────────────┐│
│  │                                 ││
│  │    🎨 [איור של V ירוק           ││
│  │        עם קונפטי]               ││
│  │                                 ││
│  └─────────────────────────────────┘│
│                                     │
│    התחל להשתמש ב-MemoZap            │
│    וגלה כמה פשוט לנהל רשימות!       │
│                                     │
│                                     │
│         ○ ○ ●                       │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │        בואו נתחיל! 🚀            │ │
│ └─────────────────────────────────┘ │
│                                     │
│   [← חזרה]                          │
│                                     │
└─────────────────────────────────────┘
```

**SharedPreferences:**
- לחיצה על "בואו נתחיל!" → `seen_onboarding = true`
- מעבר ל-Login Screen

---

### מסך התחברות (Login)

#### עיצוב - Sticky Notes Design System

```
┌─────────────────────────────────────┐
│ ║║║║║║║║║║║║║║║║║║║║║║║║║║║║║║║║║║ │ ← רקע מחברת
│──────────────────────────────────── │ ← קו אדום
│                                     │
│        ┌─────────────┐              │
│        │   🛒📝      │ ← פתק צהוב   │
│        │   MemoZap   │   מסובב     │
│        └─────────────┘              │
│                                     │
│     ┌───────────────────────┐       │
│     │   ברוכים השבים!       │ ← פתק │
│     │   התחברו לחשבון       │   לבן │
│     └───────────────────────┘       │
│                                     │
│  ┌──────────────────────────────┐   │
│  │ 📧 אימייל                    │   │ ← פתק תכלת
│  │ ┌──────────────────────────┐ │   │
│  │ │ your@email.com           │ │   │
│  │ └──────────────────────────┘ │   │
│  └──────────────────────────────┘   │
│                                     │
│  ┌──────────────────────────────┐   │
│  │ 🔒 סיסמה                     │   │ ← פתק ירוק
│  │ ┌──────────────────────────┐ │   │
│  │ │ ••••••••           👁️    │ │   │
│  │ └──────────────────────────┘ │   │
│  └──────────────────────────────┘   │
│                                     │
│                    שכחת סיסמה? ←    │
│                                     │
│  ┌──────────────────────────────┐   │
│  │         התחברות              │   │ ← כפתור ירוק
│  └──────────────────────────────┘   │
│                                     │
│  ┌──────────────────────────────┐   │
│  │ אין לך חשבון? הירשם עכשיו ← │   │ ← פתק ורוד
│  └──────────────────────────────┘   │
│                                     │
└─────────────────────────────────────┘
```

#### שדות הטופס

| שדה | סוג | ולידציה | חובה |
|-----|-----|---------|------|
| אימייל | TextInputType.emailAddress | מכיל @ | ✅ |
| סיסמה | obscureText | מינימום 6 תווים | ✅ |

#### פעולות

| פעולה | התנהגות |
|-------|---------|
| התחברות | Firebase Auth → signInWithEmailAndPassword |
| שכחת סיסמה | פתיחת Dialog להזנת אימייל → sendPasswordResetEmail |
| הירשם עכשיו | ניווט ל-RegisterScreen |
| לחיצת Back | חסום! SnackBar: "יש להשלים התחברות" |

#### הודעות שגיאה (בעברית)

| קוד Firebase | הודעה |
|--------------|-------|
| user-not-found | משתמש לא נמצא |
| wrong-password | סיסמה שגויה |
| invalid-email | כתובת אימייל לא תקינה |
| too-many-requests | יותר מדי ניסיונות, נסה מאוחר יותר |
| network-request-failed | בעיית חיבור לאינטרנט |

---

### מסך הרשמה (Register)

#### עיצוב - Sticky Notes Design System

```
┌─────────────────────────────────────┐
│ ║║║║║║║║║║║║║║║║║║║║║║║║║║║║║║║║║║ │
│──────────────────────────────────── │
│                                     │
│        ┌─────────────┐              │
│        │   🛒📝      │              │
│        │   MemoZap   │              │
│        └─────────────┘              │
│                                     │
│     ┌───────────────────────┐       │
│     │   צור חשבון חדש       │       │
│     │   בואו נתחיל!         │       │
│     └───────────────────────┘       │
│                                     │
│  ┌──────────────────────────────┐   │
│  │ 👤 שם מלא                    │   │ ← פתק סגול
│  │ ┌──────────────────────────┐ │   │
│  │ │ יוני כהן                 │ │   │
│  │ └──────────────────────────┘ │   │
│  └──────────────────────────────┘   │
│                                     │
│  ┌──────────────────────────────┐   │
│  │ 📧 אימייל                    │   │ ← פתק תכלת
│  │ ┌──────────────────────────┐ │   │
│  │ │ your@email.com           │ │   │
│  │ └──────────────────────────┘ │   │
│  └──────────────────────────────┘   │
│                                     │
│  ┌──────────────────────────────┐   │
│  │ 📱 טלפון                     │   │ ← פתק כתום (חדש!)
│  │ ┌──────────────────────────┐ │   │
│  │ │ 050-1234567              │ │   │
│  │ └──────────────────────────┘ │   │
│  └──────────────────────────────┘   │
│                                     │
│  ┌──────────────────────────────┐   │
│  │ 🔒 סיסמה                     │   │ ← פתק ירוק
│  │ ┌──────────────────────────┐ │   │
│  │ │ ••••••••           👁️    │ │   │
│  │ └──────────────────────────┘ │   │
│  └──────────────────────────────┘   │
│                                     │
│  ┌──────────────────────────────┐   │
│  │ 🔒 אימות סיסמה               │   │ ← פתק ורוד
│  │ ┌──────────────────────────┐ │   │
│  │ │ ••••••••           👁️    │ │   │
│  │ └──────────────────────────┘ │   │
│  └──────────────────────────────┘   │
│                                     │
│  ┌──────────────────────────────┐   │
│  │          הירשם               │   │
│  └──────────────────────────────┘   │
│                                     │
│  ┌──────────────────────────────┐   │
│  │ יש לך חשבון? התחבר ←        │   │
│  └──────────────────────────────┘   │
│                                     │
└─────────────────────────────────────┘
```

#### שדות הטופס

| שדה | סוג | ולידציה | חובה |
|-----|-----|---------|------|
| שם מלא | text | מינימום 2 תווים | ✅ |
| אימייל | emailAddress | מכיל @ | ✅ |
| טלפון | phone | פורמט ישראלי (05X) | ✅ **חדש!** |
| סיסמה | obscureText | מינימום 6 תווים | ✅ |
| אימות סיסמה | obscureText | תואם לסיסמה | ✅ |

#### ולידציית טלפון (חדש!)

```dart
// פורמט ישראלי תקין
final phoneRegex = RegExp(r'^05[0-9]-?[0-9]{7}$');

// דוגמאות תקינות:
// 0501234567
// 050-1234567

// נורמליזציה לפני שמירה:
phone = phone.replaceAll('-', '').replaceAll(' ', '');
// תוצאה: "0501234567"
```

#### מה קורה אחרי הרשמה?

```
1. Firebase Auth - createUserWithEmailAndPassword
2. עדכון displayName
3. יצירת מסמך ב-Firestore:
   /users/{userId}
   ├── email: "yoni@gmail.com"
   ├── name: "יוני כהן"
   ├── phone: "0501234567"        ← חדש!
   ├── avatar_emoji: "👤"
   ├── created_at: timestamp
   ├── groups: []                  ← רשימת קבוצות
   └── settings: {
         notifications: true,
         dark_mode: false
       }
4. ניווט ל-Home Dashboard
```

#### הודעות שגיאה (בעברית)

| קוד Firebase | הודעה |
|--------------|-------|
| email-already-in-use | כתובת האימייל כבר בשימוש |
| weak-password | הסיסמה חלשה מדי |
| invalid-email | כתובת אימייל לא תקינה |
| network-request-failed | בעיית חיבור לאינטרנט |

---

### איפוס סיסמה

#### Dialog איפוס סיסמה

```
┌─────────────────────────────────────┐
│                                     │
│         🔑 שכחת סיסמה?              │
│                                     │
│  הזן את כתובת האימייל שלך ונשלח     │
│  לך קישור לאיפוס הסיסמה.            │
│                                     │
│  ┌──────────────────────────────┐   │
│  │ 📧 your@email.com            │   │
│  └──────────────────────────────┘   │
│                                     │
│                                     │
│     [ביטול]        [שלח קישור]      │
│                                     │
└─────────────────────────────────────┘
```

**לחיצה על "שלח קישור":**
1. Firebase Auth → sendPasswordResetEmail
2. SnackBar ירוק: "נשלח מייל לאיפוס סיסמה"
3. המשתמש מקבל מייל עם קישור לאיפוס

---

### מבנה משתמש ב-Firestore

```
/users/{userId}
├── email: "yoni@gmail.com"
├── name: "יוני כהן"
├── phone: "0501234567"           ← חדש! לקוד הזמנה
├── avatar_emoji: "👤"            ← ברירת מחדל, ניתן לשינוי
├── avatar_url: null              ← אם העלה תמונה
├── created_at: timestamp
├── updated_at: timestamp
├── groups: ["group_abc", ...]    ← מזהי קבוצות
├── family_id: null | "family_xyz" ← קבוצת משפחה (אחת בלבד!)
├── settings: {
│     notifications_enabled: true,
│     dark_mode: false,
│     default_store: null | "שופרסל",
│     language: "he"
│   }
└── fcm_token: "..."              ← לפוש נוטיפיקציות
```

---

### קבצים קיימים

| קובץ | סטטוס | הערות |
|------|-------|-------|
| `lib/screens/auth/login_screen.dart` | ✅ קיים | Sticky Notes Design |
| `lib/screens/auth/register_screen.dart` | ✅ קיים | חסר שדה טלפון! |
| `lib/services/auth_service.dart` | ✅ קיים | Firebase Auth wrapper |
| `lib/providers/user_context.dart` | ✅ קיים | State management |

### שינויים נדרשים

1. **register_screen.dart** - להוסיף שדה טלפון (חובה)
2. **auth_service.dart** - לעדכן signUp לקבל phone
3. **user_context.dart** - ליצור מסמך Firestore עם phone
4. **Onboarding screens** - ליצור 3 מסכים חדשים

---

## קבצים לעדכון/למחוק

### קבצים להסרה (לא בשימוש)
- [ ] `lib/config/household_config.dart` - סוגי משקי בית לא רלוונטיים

### קבצים לשמירה לעתיד
- [ ] `lib/config/stores_config.dart` - אולי נשתמש בעתיד

### קבצים קיימים ורלוונטיים
- [x] `lib/config/app_config.dart` - הגדרות סביבה
- [x] `lib/config/list_types_config.dart` - סוגי רשימות
- [x] `lib/config/filters_config.dart` - סינון מזווה
- [x] `lib/config/storage_locations_config.dart` - מיקומי אחסון

---

## מבנה ניווט

### Bottom Navigation - 4 טאבים

```
┌──────────┬──────────┬──────────┬──────────┐
│   🏠     │   👨‍👩‍👧    │   👥     │   ⚙️     │
│   בית    │  משפחה   │  קבוצות  │  הגדרות  │
└──────────┴──────────┴──────────┴──────────┘
```

| טאב | תיאור | תוכן |
|-----|-------|------|
| בית | דשבורד מרכזי | סיכום, התראות, גישה מהירה |
| משפחה | רשימות משפחתיות ואישיות | טאבים פנימיים |
| קבוצות | ועד בית, ועד גן וכו' | רשימת הקבוצות + כניסה לכל אחת |
| הגדרות | הגדרות האפליקציה | פרופיל, התראות, עזרה |

### טאב "משפחה" - מבנה פנימי

```
┌─────────────────────────────────────┐
│ רשימות │ מזווה │ אישי              │  ← TabBar פנימי
├─────────────────────────────────────┤
│                                     │
│    תוכן לפי הטאב הפנימי שנבחר       │
│                                     │
└─────────────────────────────────────┘
```

| טאב פנימי | תוכן |
|-----------|------|
| רשימות | רשימות קניות משפחתיות משותפות |
| מזווה | ניהול מלאי הבית |
| אישי | רשימות פרטיות של המשתמש |

**הערה:** אם המשתמש לא חבר במשפחה:
- מזווה = מזווה אישי (לא משפחתי)
- רשימות = ריק או הודעה "צור/הצטרף למשפחה"

---

## מסך הבית (Dashboard)

### מבנה המסך

```
┌─────────────────────────────────────┐
│ 👋 שלום יוני!                       │
├─────────────────────────────────────┤
│ ⚠️ דורש תשומת לב:                   │
│ • 3 פריטים במלאי נמוך               │
│ • הצבעה נסגרת מחר                   │
│ • רשימת חנוכה - חסרים 5 מתנדבים    │
├─────────────────────────────────────┤
│ 🚀 גישה מהירה:                      │
│ ┌─────────┐ ┌─────────┐            │
│ │ 📦      │ │ 🛒      │            │
│ │ מזווה   │ │ קנייה   │            │
│ └─────────┘ └─────────┘            │
├─────────────────────────────────────┤
│ 📊 פעילות אחרונה:                   │
│ • ועד גן: יוסי סימן "אני מביא"     │
│ • ועד בית: הצבעה חדשה              │
│ • משפחה: רונית עדכנה את הרשימה      │
├─────────────────────────────────────┤
│ 📁 הקבוצות שלי:                     │
│ [👨‍👩‍👧 משפחה] [🏢 ועד בית] [🧒 ועד גן] │
└─────────────────────────────────────┘
```

### רכיבי מסך הבית

#### 1. כותרת ברכה
- שלום + שם המשתמש
- אופציונלי: תאריך/שעה

#### 2. אזור "דורש תשומת לב"
מציג התראות חשובות מכל הקבוצות:
- מלאי נמוך (מזווה משפחתי)
- הצבעות שנסגרות בקרוב
- רשימות "מי מביא" עם חוסרים
- בקשות ממתינות לאישור (לאדמינים)
- הזמנות לקבוצות חדשות

**אם אין התראות:** מסתיר את האזור או מציג הודעה חיובית

#### 3. כפתורי גישה מהירה
שני כפתורים גדולים:
- **📦 מזווה** - מעבר ישיר למזווה (טאב משפחה > מזווה)
- **🛒 קנייה** - מעבר לרשימת הקניות הפעילה / בחירת רשימה

**התנהגות כפתור קנייה:**
- אם יש רשימה אחת פעילה → נכנס ישר למצב קנייה
- אם יש כמה רשימות → פותח דיאלוג בחירה
- אם אין רשימות → מציע ליצור רשימה חדשה

#### 4. פעילות אחרונה
Feed של עדכונים מכל הקבוצות:
- סימוני "אני מביא" חדשים
- הצבעות חדשות
- עדכונים לרשימות
- חברים שהצטרפו/עזבו

**הגבלה:** מציג 5-10 פריטים אחרונים עם כפתור "עוד"

#### 5. קיצורי קבוצות
שורה של כפתורים/chips לגישה מהירה לקבוצות:
- לחיצה → מעבר לטאב קבוצות עם הקבוצה הספציפית פתוחה
- כפתור "+" ליצירת קבוצה חדשה

---

## מסך קבוצות ומערכת ניהול קבוצות

### מבנה מסך רשימת הקבוצות

```
┌─────────────────────────────────────┐
│ 👥 הקבוצות שלי              [+]    │
├─────────────────────────────────────┤
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 🏢 ועד בית הרצל 5              │ │
│ │    12 חברים • 3 רשימות פעילות  │ │
│ │    📊 הצבעה חדשה              ← │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 🧒 ועד גן הפרחים               │ │
│ │    8 חברים • 2 רשימות פעילות   │ │
│ │    🎉 מסיבת חנוכה - 5 חסרים   ← │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 📋 קבוצת ריצה שכונתית          │ │
│ │    15 חברים • 1 רשימה פעילה    │ │
│ └─────────────────────────────────┘ │
│                                     │
├─────────────────────────────────────┤
│         [+ צור קבוצה חדשה]          │
└─────────────────────────────────────┘
```

---

### יצירת קבוצה חדשה

#### שלב 1: בחירת סוג קבוצה
```
┌─────────────────────────────────────┐
│ ← יצירת קבוצה חדשה                  │
├─────────────────────────────────────┤
│                                     │
│ בחר סוג קבוצה:                      │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 🏢 ועד בית                      │ │
│ │    לניהול בניין משותף           │ │
│ │    הצבעות, משימות, תשלומים      │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 🧒 ועד גן / כיתה                │ │
│ │    לניהול אירועים וגיוסים       │ │
│ │    מי מביא, הצבעות, משימות      │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 📋 קבוצה כללית                  │ │
│ │    לכל מטרה אחרת                │ │
│ │    כל סוגי הרשימות זמינים       │ │
│ └─────────────────────────────────┘ │
│                                     │
└─────────────────────────────────────┘
```

#### שלב 2: פרטי הקבוצה
```
┌─────────────────────────────────────┐
│ ← יצירת ועד בית                     │
├─────────────────────────────────────┤
│                                     │
│         ┌──────────┐                │
│         │   📷     │                │
│         │ הוסף     │                │
│         │ תמונה    │                │
│         └──────────┘                │
│                                     │
│ שם הקבוצה:                          │
│ ┌────────────────────────────────┐  │
│ │ ועד בית הרצל 5                 │  │
│ └────────────────────────────────┘  │
│                                     │
│ תיאור (אופציונלי):                  │
│ ┌────────────────────────────────┐  │
│ │ ועד הבית של רחוב הרצל 5,      │  │
│ │ תל אביב                        │  │
│ └────────────────────────────────┘  │
│                                     │
│ ┌────────────────────────────────┐  │
│ │           המשך →               │  │
│ └────────────────────────────────┘  │
└─────────────────────────────────────┘
```

#### שלב 3: הזמנת חברים (אופציונלי)
```
┌─────────────────────────────────────┐
│ ← הזמנת חברים                       │
├─────────────────────────────────────┤
│                                     │
│ 🔍 חיפוש אנשי קשר...                │
│ ┌────────────────────────────────┐  │
│ │                                │  │
│ └────────────────────────────────┘  │
│                                     │
│ נבחרו (3):                          │
│ ┌────────────────────────────────┐  │
│ │ ✓ יוסי כהן        [אדמין ▼]   │  │
│ │   050-1234567                  │  │
│ ├────────────────────────────────┤  │
│ │ ✓ רונית לוי       [חבר ▼]     │  │
│ │   052-9876543                  │  │
│ ├────────────────────────────────┤  │
│ │ ✓ דני שמעון       [חבר ▼]     │  │
│ │   054-5555555                  │  │
│ └────────────────────────────────┘  │
│                                     │
│ 💡 תוכל להזמין עוד חברים מאוחר יותר │
│                                     │
│ ┌──────────┐ ┌───────────────────┐  │
│ │ דלג      │ │    צור קבוצה      │  │
│ └──────────┘ └───────────────────┘  │
└─────────────────────────────────────┘
```

---

### מסך קבוצה ספציפית

#### תצוגה רגילה
```
┌─────────────────────────────────────┐
│ ← 🏢 ועד בית הרצל 5          [⚙️] │
├─────────────────────────────────────┤
│                                     │
│ 📋 רשימות פעילות (3):               │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 🗳️ להחליף ספק אינטרנט?        → │ │
│ │    הצבעה • נסגרת ב-20/12       │ │
│ │    הצבעת: בעד ✓                │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 🎉 ארוחת שכנים - מי מביא       → │ │
│ │    מי מביא • 8/15 מתנדבים      │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ ✓ משימות לפני פסח              → │ │
│ │    צ'קליסט • 4/10 הושלמו       │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ 📁 רשימות שהסתיימו (5)          ▼  │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ 👥 חברים (12)                       │
│ ┌────────────────────────────────┐  │
│ │ [👤] [👩] [👨] [👧] [+8...]     │  │
│ └────────────────────────────────┘  │
│                                     │
├─────────────────────────────────────┤
│         [+ צור רשימה חדשה]          │
└─────────────────────────────────────┘
```

#### יצירת רשימה חדשה בקבוצה
```
┌─────────────────────────────────────┐
│ ← רשימה חדשה                        │
├─────────────────────────────────────┤
│                                     │
│ בחר סוג רשימה:                      │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 🗳️ הצבעה                        │ │
│ │    קבלת החלטות דמוקרטית         │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 🎉 מי מביא                      │ │
│ │    חלוקת אחריות לאירוע          │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ ✓ צ'קליסט                       │ │
│ │    רשימת משימות לסימון          │ │
│ └─────────────────────────────────┘ │
│                                     │
└─────────────────────────────────────┘
```

---

### הגדרות קבוצה (מסך מלא)

#### תצוגה - לבעלים/אדמין
```
┌─────────────────────────────────────┐
│ ← הגדרות קבוצה                      │
├─────────────────────────────────────┤
│                                     │
│ ╔═══════════════════════════════════╗
│ ║ 📝 פרטי הקבוצה                    ║
│ ╠═══════════════════════════════════╣
│ ║       ┌──────────┐                ║
│ ║       │   🏢     │                ║
│ ║       └──────────┘                ║
│ ║                                   ║
│ ║ שם: ועד בית הרצל 5               ║
│ ║ סוג: ועד בית                      ║
│ ║ נוצר: 01/01/2025                  ║
│ ║                                   ║
│ ║              [✏️ עריכה]           ║
│ ╚═══════════════════════════════════╝
│                                     │
│ ╔═══════════════════════════════════╗
│ ║ 👥 ניהול חברים                    ║
│ ╠═══════════════════════════════════╣
│ ║ חברים פעילים: 12                  ║
│ ║ הזמנות ממתינות: 2                 ║
│ ║                                   ║
│ ║     [ניהול חברים והזמנות →]       ║
│ ╚═══════════════════════════════════╝
│                                     │
│ ╔═══════════════════════════════════╗
│ ║ 🔗 קוד הצטרפות                    ║
│ ╠═══════════════════════════════════╣
│ ║ קוד: XYZ789                       ║
│ ║ תוקף: עוד 6 ימים                  ║
│ ║                                   ║
│ ║ [העתק] [שתף] [צור קוד חדש]       ║
│ ╚═══════════════════════════════════╝
│                                     │
│ ╔═══════════════════════════════════╗
│ ║ 🔔 התראות קבוצה                   ║
│ ╠═══════════════════════════════════╣
│ ║ הצבעות חדשות           [●]       ║
│ ║ "מי מביא" חדש          [●]       ║
│ ║ עדכונים לרשימות        [●]       ║
│ ║ חברים חדשים            [●]       ║
│ ╚═══════════════════════════════════╝
│                                     │
│ ╔═══════════════════════════════════╗
│ ║ 📊 סטטיסטיקות                     ║
│ ╠═══════════════════════════════════╣
│ ║ רשימות פעילות: 3                  ║
│ ║ רשימות שהסתיימו: 15               ║
│ ║ הצבעות שנסגרו: 8                  ║
│ ╚═══════════════════════════════════╝
│                                     │
│ ┌───────────────────────────────────┐
│ │ 🚪 עזוב קבוצה                     │
│ └───────────────────────────────────┘
│                                     │
│ ┌───────────────────────────────────┐
│ │ 🗑️ מחק קבוצה                     │  ← רק לבעלים
│ └───────────────────────────────────┘
│                                     │
└─────────────────────────────────────┘
```

#### תצוגה - לחבר רגיל
```
┌─────────────────────────────────────┐
│ ← הגדרות קבוצה                      │
├─────────────────────────────────────┤
│                                     │
│ ╔═══════════════════════════════════╗
│ ║ 📝 פרטי הקבוצה                    ║
│ ╠═══════════════════════════════════╣
│ ║       ┌──────────┐                ║
│ ║       │   🏢     │                ║
│ ║       └──────────┘                ║
│ ║                                   ║
│ ║ שם: ועד בית הרצל 5               ║
│ ║ סוג: ועד בית                      ║
│ ║ חברים: 12                         ║
│ ╚═══════════════════════════════════╝
│                                     │
│ ╔═══════════════════════════════════╗
│ ║ 🔔 התראות קבוצה                   ║
│ ╠═══════════════════════════════════╣
│ ║ הצבעות חדשות           [●]       ║
│ ║ "מי מביא" חדש          [●]       ║
│ ║ עדכונים לרשימות        [●]       ║
│ ╚═══════════════════════════════════╝
│                                     │
│ ┌───────────────────────────────────┐
│ │ 🚪 עזוב קבוצה                     │
│ └───────────────────────────────────┘
│                                     │
└─────────────────────────────────────┘
```

---

### ניהול חברי קבוצה

#### מסך ניהול חברים (לבעלים/אדמין)
```
┌─────────────────────────────────────┐
│ ← ניהול חברים                       │
├─────────────────────────────────────┤
│                                     │
│ 🔗 קוד הצטרפות: XYZ789              │
│    [העתק] [שתף בוואטסאפ]            │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ 👥 חברים פעילים (12):               │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 👤 יוני כהן            בעלים   │ │
│ │    yoni@email.com               │ │
│ │    הצטרף: 01/01/2025            │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 👩 רונית לוי           אדמין   │ │
│ │    ronit@email.com      [⚙️]   │ │
│ │    הצטרף: 02/01/2025            │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 👨 דני שמעון           חבר     │ │
│ │    dani@email.com       [⚙️]   │ │
│ │    הצטרף: 03/01/2025            │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ ⏳ הזמנות ממתינות (2):              │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 📧 michal@email.com             │ │
│ │    נשלח: לפני 2 ימים    [❌]   │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌────────────────────────────────┐  │
│ │        + הזמן חבר חדש          │  │
│ └────────────────────────────────┘  │
└─────────────────────────────────────┘
```

#### עריכת חבר (Bottom Sheet)
```
┌─────────────────────────────────────┐
│ ═══════════════                     │
│                                     │
│ 👩 רונית לוי                        │
│ ronit@email.com                     │
│ הצטרפה: 02/01/2025                  │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ שנה תפקיד:                          │
│ ┌─────────────────────────────────┐ │
│ │ ○ בעלים (לא ניתן לשינוי)        │ │
│ │ ● אדמין                         │ │
│ │ ○ חבר                           │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 🚫 הסר מהקבוצה                  │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌──────────┐ ┌───────────────────┐  │
│ │ ביטול    │ │      שמור         │  │
│ └──────────┘ └───────────────────┘  │
└─────────────────────────────────────┘
```

#### הזמנת חבר חדש (Bottom Sheet)
```
┌─────────────────────────────────────┐
│ ═══════════════                     │
│                                     │
│ הזמנת חבר חדש                       │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ אימייל או טלפון:                    │
│ ┌────────────────────────────────┐  │
│ │ michal@email.com               │  │
│ └────────────────────────────────┘  │
│                                     │
│ תפקיד:                              │
│ ┌─────────────────────────────────┐ │
│ │ ○ אדמין                         │ │
│ │ ● חבר                           │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ או שתף קוד הצטרפות:                 │
│                                     │
│ ┌────────────────────────────────┐  │
│ │     📤 שתף קוד בוואטסאפ        │  │
│ └────────────────────────────────┘  │
│                                     │
│ ┌──────────┐ ┌───────────────────┐  │
│ │ ביטול    │ │   שלח הזמנה       │  │
│ └──────────┘ └───────────────────┘  │
└─────────────────────────────────────┘
```

---

### הצטרפות לקבוצה

#### הזנת קוד הצטרפות
```
┌─────────────────────────────────────┐
│ ← הצטרפות לקבוצה                    │
├─────────────────────────────────────┤
│                                     │
│ הזן קוד הצטרפות:                    │
│                                     │
│ ┌────────────────────────────────┐  │
│ │         XYZ789                 │  │
│ └────────────────────────────────┘  │
│                                     │
│ 💡 קיבלת קוד מחבר? הזן אותו כאן     │
│                                     │
│ ┌────────────────────────────────┐  │
│ │           הצטרף                │  │
│ └────────────────────────────────┘  │
│                                     │
└─────────────────────────────────────┘
```

#### אישור הצטרפות
```
┌─────────────────────────────────────┐
│ הצטרפות לקבוצה                      │
├─────────────────────────────────────┤
│                                     │
│       ┌──────────┐                  │
│       │   🏢     │                  │
│       └──────────┘                  │
│                                     │
│    ועד בית הרצל 5                   │
│    12 חברים                         │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ להצטרף לקבוצה זו?                   │
│                                     │
│ ┌──────────┐ ┌───────────────────┐  │
│ │ ביטול    │ │     הצטרף         │  │
│ └──────────┘ └───────────────────┘  │
└─────────────────────────────────────┘
```

---

### עזיבת קבוצה

#### דיאלוג אישור - חבר רגיל
```
┌─────────────────────────────────────┐
│ עזיבת קבוצה                         │
├─────────────────────────────────────┤
│                                     │
│ האם לעזוב את "ועד בית הרצל 5"?      │
│                                     │
│ שים לב:                             │
│ • לא תוכל לגשת לרשימות הקבוצה       │
│ • סימוני "אני מביא" שלך יבוטלו     │
│ • הצבעות שלך יוסרו                  │
│                                     │
│ ┌──────────┐ ┌───────────────────┐  │
│ │ ביטול    │ │   עזוב קבוצה      │  │
│ └──────────┘ └───────────────────┘  │
└─────────────────────────────────────┘
```

#### דיאלוג אישור - בעלים
```
┌─────────────────────────────────────┐
│ ⚠️ עזיבת קבוצה - בעלים             │
├─────────────────────────────────────┤
│                                     │
│ אתה הבעלים של הקבוצה!               │
│                                     │
│ לפני שתעזוב, עליך:                  │
│                                     │
│ ○ להעביר בעלות לאדמין אחר           │
│ ○ למחוק את הקבוצה                   │
│                                     │
│ בחר אדמין חדש:                      │
│ ┌─────────────────────────────────┐ │
│ │ ○ רונית לוי (אדמין)             │ │
│ │ ○ דני שמעון (אדמין)             │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌──────────┐ ┌───────────────────┐  │
│ │ ביטול    │ │ העבר ועזוב        │  │
│ └──────────┘ └───────────────────┘  │
│                                     │
│ ──────── או ────────                │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 🗑️ מחק את הקבוצה לצמיתות       │ │
│ └─────────────────────────────────┘ │
└─────────────────────────────────────┘
```

---

### מחיקת קבוצה

#### דיאלוג אישור (רק לבעלים)
```
┌─────────────────────────────────────┐
│ ⚠️ מחיקת קבוצה                      │
├─────────────────────────────────────┤
│                                     │
│ האם למחוק את "ועד בית הרצל 5"?      │
│                                     │
│ פעולה זו תמחק:                      │
│ • את הקבוצה לצמיתות                 │
│ • את כל הרשימות (15 רשימות)         │
│ • את כל ההיסטוריה                   │
│ • לכל 12 החברים                     │
│                                     │
│ ⚠️ פעולה זו בלתי הפיכה!             │
│                                     │
│ הקלד "מחק" לאישור:                  │
│ ┌────────────────────────────────┐  │
│ │                                │  │
│ └────────────────────────────────┘  │
│                                     │
│ ┌──────────┐ ┌───────────────────┐  │
│ │ ביטול    │ │   מחק לצמיתות     │  │
│ └──────────┘ └───────────────────┘  │
└─────────────────────────────────────┘
```

---

### הרשאות בקבוצה - טבלה מפורטת

| פעולה | בעלים | אדמין | חבר |
|-------|-------|-------|-----|
| **קבוצה** | | | |
| צפייה בקבוצה | ✅ | ✅ | ✅ |
| עריכת שם/תמונה | ✅ | ✅ | ❌ |
| מחיקת קבוצה | ✅ | ❌ | ❌ |
| עזיבת קבוצה | ✅* | ✅ | ✅ |
| **חברים** | | | |
| צפייה בחברים | ✅ | ✅ | ✅ |
| הזמנת חברים | ✅ | ✅ | ❌ |
| הסרת חברים | ✅ | ✅** | ❌ |
| שינוי תפקיד חבר | ✅ | ❌ | ❌ |
| **רשימות** | | | |
| צפייה ברשימות | ✅ | ✅ | ✅ |
| יצירת רשימה | ✅ | ✅ | ❌ |
| עריכת רשימה | ✅ | ✅ | ❌ |
| מחיקת רשימה | ✅ | ✅*** | ❌ |
| **פעולות ברשימה** | | | |
| הצבעה | ✅ | ✅ | ✅ |
| סימון "אני מביא" | ✅ | ✅ | ✅ |
| ביטול סימון של אחרים | ✅ | ✅ | ❌ |
| סימון V בצ'קליסט | ✅ | ✅ | ✅ |

**הערות:**
- \* בעלים חייב להעביר בעלות או למחוק קבוצה לפני עזיבה
- \** אדמין לא יכול להסיר אדמינים אחרים או בעלים
- \*** אדמין יכול למחוק רק רשימות שהוא יצר

---

### מבנה Firestore - קבוצה

```
/groups/{groupId}
├── name: "ועד בית הרצל 5"
├── type: "building" | "kindergarten" | "other"
├── description: "ועד הבית של רחוב הרצל 5..."
├── image_url: "https://..." | null
├── created_by: "user_abc"
├── created_at: timestamp
├── updated_at: timestamp
├── members_count: 12
├── active_lists_count: 3
├── members: {
│     "user_abc": {
│       role: "owner",
│       joined_at: timestamp,
│       name: "יוני כהן",
│       avatar: "👤"
│     },
│     "user_def": {
│       role: "admin",
│       joined_at: timestamp,
│       name: "רונית לוי",
│       avatar: "👩"
│     },
│     "user_ghi": {
│       role: "member",
│       joined_at: timestamp,
│       name: "דני שמעון",
│       avatar: "👨"
│     }
│   }
├── join_code: {
│     code: "XYZ789",
│     created_at: timestamp,
│     expires_at: timestamp (7 ימים)
│   }
└── settings: {
      notifications_enabled: true
    }

/groups/{groupId}/lists/{listId}
├── ... (מבנה רשימה)

/groups/{groupId}/invites/{inviteId}
├── email: "michal@email.com"
├── role: "member"
├── invited_by: "user_abc"
├── invited_at: timestamp
├── status: "pending" | "accepted" | "declined" | "expired"
└── expires_at: timestamp
```

---

### התראות קבוצה

| אירוע | מקבלי ההתראה | תוכן |
|-------|--------------|------|
| חבר חדש הצטרף | בעלים + אדמינים | "יוסי הצטרף לקבוצה" |
| חבר עזב | בעלים + אדמינים | "יוסי עזב את הקבוצה" |
| הצבעה חדשה | כל החברים | "הצבעה חדשה: להחליף ספק?" |
| הצבעה נסגרת | מי שלא הצביע | "נותרו 24 שעות להצביע" |
| הצבעה נסגרה | כל החברים | "ההצבעה נסגרה: אושר ברוב" |
| "מי מביא" חדש | כל החברים | "יוסי סימן שהוא מביא סופגניות" |
| רשימה חדשה | כל החברים | "רשימה חדשה: מסיבת חנוכה" |
| רשימה הושלמה | כל החברים | "הרשימה 'משימות פסח' הושלמה" |

---

## מסך הגדרות

### מבנה המסך המלא

```
┌─────────────────────────────────────┐
│ ⚙️ הגדרות                           │
├─────────────────────────────────────┤
│                                     │
│ ╔═══════════════════════════════════╗
│ ║ 👤 פרופיל אישי                    ║
│ ╠═══════════════════════════════════╣
│ ║ [👤]  יוני כהן                    ║
│ ║       yoni@email.com              ║
│ ║       050-1234567                 ║
│ ║                     [עריכה]       ║
│ ╚═══════════════════════════════════╝
│                                     │
│ ╔═══════════════════════════════════╗
│ ║ 👨‍👩‍👧 המשפחה שלי                    ║
│ ╠═══════════════════════════════════╣
│ ║ משפחת כהן           [4 חברים]    ║
│ ║ תפקיד: בעלים                      ║
│ ║                                   ║
│ ║ [ניהול חברים]  [עזיבת משפחה]     ║
│ ║                                   ║
│ ║ ─── או ───                        ║
│ ║                                   ║
│ ║ [+ צור משפחה חדשה]                ║
│ ║ [הזן קוד הזמנה]                   ║
│ ╚═══════════════════════════════════╝
│                                     │
│ ╔═══════════════════════════════════╗
│ ║ 🔔 התראות                         ║
│ ╠═══════════════════════════════════╣
│ ║ ── כללי ──                        ║
│ ║ הזמנות לקבוצות         [●]        ║
│ ║                                   ║
│ ║ ── משפחה ──                       ║
│ ║ מלאי נמוך              [●]        ║
│ ║ עדכונים לרשימות        [●]        ║
│ ║                                   ║
│ ║ ── קבוצות ──                      ║
│ ║ הצבעות חדשות           [●]        ║
│ ║ "מי מביא" חדש          [●]        ║
│ ║ תזכורות הצבעה          [●]        ║
│ ║ בקשות ממתינות          [●]        ║
│ ╚═══════════════════════════════════╝
│                                     │
│ ╔═══════════════════════════════════╗
│ ║ 🎨 תצוגה                          ║
│ ╠═══════════════════════════════════╣
│ ║ ערכת נושא         [אוטומטי ▼]    ║
│ ║   ○ אוטומטי (לפי מערכת)          ║
│ ║   ○ בהיר                          ║
│ ║   ○ כהה                           ║
│ ║                                   ║
│ ║ גודל טקסט         [רגיל ▼]       ║
│ ║   ○ קטן                           ║
│ ║   ○ רגיל                          ║
│ ║   ○ גדול                          ║
│ ╚═══════════════════════════════════╝
│                                     │
│ ╔═══════════════════════════════════╗
│ ║ 🛒 קניות                          ║
│ ╠═══════════════════════════════════╣
│ ║ סידור רשימה לפי:   [קטגוריה ▼]   ║
│ ║   ○ סדר הוספה                     ║
│ ║   ○ קטגוריה                       ║
│ ║   ○ א-ב                           ║
│ ║                                   ║
│ ║ הצג מחירים משוערים     [●]        ║
│ ║ הוסף למזווה אוטומטית   [●]        ║
│ ╚═══════════════════════════════════╝
│                                     │
│ ╔═══════════════════════════════════╗
│ ║ 📦 מזווה                          ║
│ ╠═══════════════════════════════════╣
│ ║ התראת מלאי נמוך        [●]        ║
│ ║ כמות מינימום ברירת מחדל: [1]     ║
│ ║                                   ║
│ ║ הצעת מוצרים קבועים     [●]        ║
│ ║ (אחרי 4 קניות של אותו מוצר)      ║
│ ╚═══════════════════════════════════╝
│                                     │
│ ╔═══════════════════════════════════╗
│ ║ 📋 מידע                           ║
│ ╠═══════════════════════════════════╣
│ ║ גרסה                    v1.0.0    ║
│ ║ תנאי שימוש                    →   ║
│ ║ מדיניות פרטיות                →   ║
│ ║ עזרה ותמיכה                   →   ║
│ ║ דרג אותנו ⭐                  →   ║
│ ║ שתף את האפליקציה              →   ║
│ ╚═══════════════════════════════════╝
│                                     │
│ ╔═══════════════════════════════════╗
│ ║ 🔧 מתקדם                          ║
│ ╠═══════════════════════════════════╣
│ ║ נקה cache                     →   ║
│ ║ ייצא נתונים                   →   ║
│ ║ מחק חשבון                     →   ║
│ ╚═══════════════════════════════════╝
│                                     │
│ ┌───────────────────────────────────┐
│ │ 🚪 התנתקות                        │
│ └───────────────────────────────────┘
│                                     │
└─────────────────────────────────────┘
```

---

### סעיף 1: פרופיל אישי

#### תצוגה
```
┌─────────────────────────────────────┐
│ 👤 פרופיל אישי                      │
├─────────────────────────────────────┤
│                                     │
│   ┌────┐                            │
│   │ 👤 │  יוני כהן                  │
│   └────┘  yoni@email.com            │
│           050-1234567               │
│                                     │
│                        [✏️ עריכה]   │
└─────────────────────────────────────┘
```

#### עריכת פרופיל (Bottom Sheet)
```
┌─────────────────────────────────────┐
│ ═══════════════                     │  ← Handle bar
│                                     │
│ עריכת פרופיל                        │
│                                     │
│ בחר אווטאר:                         │
│ ┌────────────────────────────────┐  │
│ │ [👤] [👩] [👨] [👧] [👦]        │  │
│ │ [🧑‍🍳] [🛒] [🏠] [👨‍👩‍👧] [👨‍👩‍👧‍👦]     │  │
│ │ [🌟] [💜] [💚] [🧡] [💙] [❤️]  │  │
│ └────────────────────────────────┘  │
│                                     │
│ שם תצוגה:                           │
│ ┌────────────────────────────────┐  │
│ │ יוני כהן                       │  │
│ └────────────────────────────────┘  │
│ מקסימום 30 תווים                    │
│                                     │
│ אימייל: yoni@email.com (לא ניתן לשינוי)
│ טלפון: 050-1234567 (לא ניתן לשינוי) │
│                                     │
│ ┌─────────┐ ┌───────────────────┐   │
│ │ ביטול   │ │      שמור         │   │
│ └─────────┘ └───────────────────┘   │
└─────────────────────────────────────┘
```

#### שדות פרופיל

| שדה | ניתן לעריכה | וולידציה | שמירה |
|-----|-------------|----------|-------|
| אווטאר | ✅ כן | בחירה מרשימה מוגדרת | Firestore |
| שם תצוגה | ✅ כן | 2-30 תווים, לא ריק | Firestore |
| אימייל | ❌ לא | - | Firebase Auth |
| טלפון | ❌ לא | - | Firestore |

---

### סעיף 2: המשפחה שלי

#### מצב: חבר במשפחה
```
┌─────────────────────────────────────┐
│ 👨‍👩‍👧 המשפחה שלי                      │
├─────────────────────────────────────┤
│                                     │
│ 🏠 משפחת כהן                        │
│                                     │
│ חברים: 4                            │
│ ┌──────────────────────────────┐    │
│ │ [👤 יוני] [👩 רונית]         │    │
│ │ [👦 דני] [👧 מיכל]           │    │
│ └──────────────────────────────┘    │
│                                     │
│ התפקיד שלי: בעלים                   │
│                                     │
│ ┌────────────┐ ┌────────────────┐   │
│ │ ניהול חברים │ │ עזיבת משפחה   │   │
│ └────────────┘ └────────────────┘   │
└─────────────────────────────────────┘
```

#### מצב: לא חבר במשפחה
```
┌─────────────────────────────────────┐
│ 👨‍👩‍👧 המשפחה שלי                      │
├─────────────────────────────────────┤
│                                     │
│ 🏠 אין משפחה מחוברת                 │
│                                     │
│ צור משפחה חדשה כדי לשתף רשימות     │
│ קניות ומזווה עם בני המשפחה.         │
│                                     │
│ ┌────────────────────────────────┐  │
│ │      + צור משפחה חדשה          │  │
│ └────────────────────────────────┘  │
│                                     │
│ ── או ──                            │
│                                     │
│ ┌────────────────────────────────┐  │
│ │      🔗 הזן קוד הזמנה          │  │
│ └────────────────────────────────┘  │
└─────────────────────────────────────┘
```

#### יצירת משפחה חדשה (Dialog)
```
┌─────────────────────────────────────┐
│ יצירת משפחה חדשה                    │
├─────────────────────────────────────┤
│                                     │
│ שם המשפחה:                          │
│ ┌────────────────────────────────┐  │
│ │ משפחת כהן                      │  │
│ └────────────────────────────────┘  │
│                                     │
│ 💡 תוכל להזמין חברי משפחה אחרי     │
│    שהמשפחה תיווצר                   │
│                                     │
│ ┌─────────┐ ┌───────────────────┐   │
│ │ ביטול   │ │    צור משפחה      │   │
│ └─────────┘ └───────────────────┘   │
└─────────────────────────────────────┘
```

#### עזיבת משפחה (Dialog)
```
┌─────────────────────────────────────┐
│ ⚠️ עזיבת משפחה                      │
├─────────────────────────────────────┤
│                                     │
│ האם לעזוב את "משפחת כהן"?           │
│                                     │
│ שים לב:                             │
│ • לא תוכל לגשת לרשימות המשפחתיות    │
│ • לא תוכל לגשת למזווה המשפחתי       │
│ • ייווצר לך מזווה אישי חדש (ריק)   │
│                                     │
│ ┌─────────┐ ┌───────────────────┐   │
│ │ ביטול   │ │   עזוב משפחה      │   │
│ └─────────┘ └───────────────────┘   │
└─────────────────────────────────────┘
```

#### ניהול חברים (מסך נפרד)
```
┌─────────────────────────────────────┐
│ ← ניהול חברי משפחה                  │
├─────────────────────────────────────┤
│                                     │
│ 🔗 קוד הזמנה: ABC123                │
│    [העתק] [שתף בוואטסאפ]            │
│    תוקף: עוד 6 ימים                 │
│                                     │
│ ───────────────────────────────────│
│                                     │
│ חברי המשפחה (4):                    │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 👤 יוני כהן           בעלים    │ │
│ │    yoni@email.com               │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 👩 רונית כהן          אדמין    │ │
│ │    ronit@email.com      [⚙️]   │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │ 👦 דני כהן            חבר      │ │
│ │    dani@email.com       [⚙️]   │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ┌────────────────────────────────┐  │
│ │      + הזמן חבר חדש            │  │
│ └────────────────────────────────┘  │
└─────────────────────────────────────┘
```

---

### סעיף 3: התראות

#### מבנה ההתראות
```
┌─────────────────────────────────────┐
│ 🔔 התראות                           │
├─────────────────────────────────────┤
│                                     │
│ כללי                                │
│ ├─ הזמנות לקבוצות         [●]      │
│ └─ עדכוני מערכת            [●]      │
│                                     │
│ משפחה                               │
│ ├─ מלאי נמוך במזווה        [●]      │
│ ├─ עדכונים לרשימות         [●]      │
│ └─ חבר חדש במשפחה          [●]      │
│                                     │
│ קבוצות                              │
│ ├─ הצבעות חדשות            [●]      │
│ ├─ תזכורת: הצבעה נסגרת     [●]      │
│ ├─ "מי מביא" חדש           [●]      │
│ ├─ בקשות ממתינות (אדמין)   [●]      │
│ └─ חבר הצטרף/עזב           [●]      │
│                                     │
└─────────────────────────────────────┘
```

#### פירוט התראות

| קטגוריה | התראה | ברירת מחדל | מתי נשלחת |
|---------|--------|------------|-----------|
| **כללי** | הזמנות לקבוצות | ✅ | כשמקבלים הזמנה לקבוצה |
| **כללי** | עדכוני מערכת | ✅ | גרסה חדשה, תחזוקה |
| **משפחה** | מלאי נמוך | ✅ | מוצר ירד מתחת לכמות מינימום |
| **משפחה** | עדכונים לרשימות | ✅ | מישהו הוסיף/עדכן פריט |
| **משפחה** | חבר חדש | ✅ | מישהו הצטרף למשפחה |
| **קבוצות** | הצבעות חדשות | ✅ | נפתחה הצבעה חדשה |
| **קבוצות** | תזכורת הצבעה | ✅ | 24 שעות לפני סגירה |
| **קבוצות** | "מי מביא" חדש | ✅ | מישהו סימן שהוא מביא |
| **קבוצות** | בקשות ממתינות | ✅ | עורך ביקש להוסיף/לערוך |
| **קבוצות** | חבר הצטרף/עזב | ✅ | שינוי בחברי הקבוצה |

---

### סעיף 4: תצוגה

```
┌─────────────────────────────────────┐
│ 🎨 תצוגה                            │
├─────────────────────────────────────┤
│                                     │
│ ערכת נושא                           │
│ ┌─────────────────────────────────┐ │
│ │ ○ 🌓 אוטומטי (לפי מערכת)       │ │
│ │ ○ ☀️ בהיר                       │ │
│ │ ○ 🌙 כהה                        │ │
│ └─────────────────────────────────┘ │
│                                     │
│ גודל טקסט                           │
│ ┌─────────────────────────────────┐ │
│ │ ○ קטן  (12px)                   │ │
│ │ ● רגיל (14px)                   │ │
│ │ ○ גדול (16px)                   │ │
│ └─────────────────────────────────┘ │
│                                     │
│ תצוגה מקדימה:                       │
│ ┌─────────────────────────────────┐ │
│ │ טקסט לדוגמה בגודל הנבחר         │ │
│ └─────────────────────────────────┘ │
│                                     │
└─────────────────────────────────────┘
```

---

### סעיף 5: הגדרות קניות

```
┌─────────────────────────────────────┐
│ 🛒 קניות                            │
├─────────────────────────────────────┤
│                                     │
│ סידור ברירת מחדל לרשימה             │
│ ┌─────────────────────────────────┐ │
│ │ ○ סדר הוספה (ראשון למעלה)      │ │
│ │ ● לפי קטגוריה                   │ │
│ │ ○ א-ב                           │ │
│ └─────────────────────────────────┘ │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ הצג מחירים משוערים          [●]    │
│ (מחירון מעודכן אוטומטית)            │
│                                     │
│ הוסף למזווה אוטומטית        [●]    │
│ (פריטים שנקנו יתווספו למזווה)       │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ נקה פריטים שנקנו            [●]    │
│ (הסר מהרשימה אחרי קנייה)            │
│                                     │
│ שמור פריטים שלא נקנו        [●]    │
│ (השאר ברשימה לפעם הבאה)             │
│                                     │
└─────────────────────────────────────┘
```

---

### סעיף 6: הגדרות מזווה

```
┌─────────────────────────────────────┐
│ 📦 מזווה                            │
├─────────────────────────────────────┤
│                                     │
│ התראות מלאי                         │
│ ─────────────────────────────────── │
│ התראה על מלאי נמוך          [●]    │
│                                     │
│ כמות מינימום ברירת מחדל             │
│ ┌─────────────────────────────────┐ │
│ │         [ - ]  1  [ + ]         │ │
│ └─────────────────────────────────┘ │
│ (ניתן לשנות לכל מוצר בנפרד)         │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ מוצרים קבועים                       │
│ ─────────────────────────────────── │
│ הצע מוצרים קבועים           [●]    │
│ (אחרי 4 קניות של אותו מוצר)         │
│                                     │
│ הוסף מוצרים קבועים אוטומטית [○]    │
│ (לרשימה חדשה)                       │
│                                     │
└─────────────────────────────────────┘
```

---

### סעיף 7: מידע

```
┌─────────────────────────────────────┐
│ 📋 מידע                             │
├─────────────────────────────────────┤
│                                     │
│ גרסה                      v1.0.0   │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ תנאי שימוש                      →   │
│                                     │
│ מדיניות פרטיות                  →   │
│                                     │
│ עזרה ותמיכה                     →   │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ ⭐ דרג אותנו בחנות              →   │
│                                     │
│ 📤 שתף את האפליקציה             →   │
│                                     │
└─────────────────────────────────────┘
```

#### עזרה ותמיכה (מסך נפרד)
```
┌─────────────────────────────────────┐
│ ← עזרה ותמיכה                       │
├─────────────────────────────────────┤
│                                     │
│ 📚 שאלות נפוצות                     │
│ ─────────────────────────────────── │
│                                     │
│ ▸ איך יוצרים רשימה חדשה?           │
│ ▸ איך מזמינים חברי משפחה?          │
│ ▸ מה זה מצב קנייה?                 │
│ ▸ איך המזווה עובד?                 │
│ ▸ איך יוצרים קבוצה?                │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ 📧 צור קשר                          │
│ ─────────────────────────────────── │
│                                     │
│ ┌────────────────────────────────┐  │
│ │      📧 שלח אימייל לתמיכה       │  │
│ └────────────────────────────────┘  │
│                                     │
│ support@memozap.app                 │
│                                     │
└─────────────────────────────────────┘
```

---

### סעיף 8: הגדרות מתקדמות

```
┌─────────────────────────────────────┐
│ 🔧 מתקדם                            │
├─────────────────────────────────────┤
│                                     │
│ נקה cache                       →   │
│ (תמונות, נתונים זמניים)             │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ ייצא נתונים                     →   │
│ (רשימות, מזווה - JSON)              │
│                                     │
│ ─────────────────────────────────── │
│                                     │
│ ⚠️ מחק חשבון                    →   │
│ (פעולה בלתי הפיכה!)                 │
│                                     │
└─────────────────────────────────────┘
```

#### מחיקת חשבון (Dialog)
```
┌─────────────────────────────────────┐
│ ⚠️ מחיקת חשבון                      │
├─────────────────────────────────────┤
│                                     │
│ האם אתה בטוח שברצונך למחוק          │
│ את החשבון לצמיתות?                  │
│                                     │
│ פעולה זו תמחק:                      │
│ • את כל הנתונים שלך                 │
│ • את כל הרשימות הפרטיות             │
│ • את ההיסטוריה                      │
│                                     │
│ ⚠️ פעולה זו בלתי הפיכה!             │
│                                     │
│ הקלד "מחק" לאישור:                  │
│ ┌────────────────────────────────┐  │
│ │                                │  │
│ └────────────────────────────────┘  │
│                                     │
│ ┌─────────┐ ┌───────────────────┐   │
│ │ ביטול   │ │   מחק לצמיתות     │   │
│ └─────────┘ └───────────────────┘   │
└─────────────────────────────────────┘
```

---

### סעיף 9: התנתקות

```
┌─────────────────────────────────────┐
│ 🚪 התנתקות                          │
├─────────────────────────────────────┤
│                                     │
│ לחץ להתנתקות מהחשבון                 │
│                                     │
└─────────────────────────────────────┘
```

#### דיאלוג אישור התנתקות
```
┌─────────────────────────────────────┐
│ התנתקות                             │
├─────────────────────────────────────┤
│                                     │
│ האם להתנתק מהחשבון?                  │
│                                     │
│ הנתונים שלך יישמרו בשרת ויחכו       │
│ לך כשתתחבר שוב.                     │
│                                     │
│ נתונים מקומיים (cache) יימחקו.      │
│                                     │
│ ┌─────────┐ ┌───────────────────┐   │
│ │ ביטול   │ │     התנתק         │   │
│ └─────────┘ └───────────────────┘   │
└─────────────────────────────────────┘
```

---

### הגדרות לשמירה - מפורט

#### SharedPreferences (מקומי)
```dart
// תצוגה
'settings.theme' : 'auto' | 'light' | 'dark'
'settings.textSize' : 'small' | 'normal' | 'large'

// קניות
'settings.listSortOrder' : 'added' | 'category' | 'alphabetical'
'settings.showPrices' : bool
'settings.autoAddToPantry' : bool
'settings.clearPurchased' : bool
'settings.keepUnpurchased' : bool

// מזווה
'settings.lowStockAlert' : bool
'settings.defaultMinQuantity' : int
'settings.suggestRecurring' : bool
'settings.autoAddRecurring' : bool

// התראות (כולן)
'notifications.groupInvites' : bool
'notifications.systemUpdates' : bool
'notifications.lowStock' : bool
'notifications.listUpdates' : bool
'notifications.newFamilyMember' : bool
'notifications.newVotes' : bool
'notifications.voteReminder' : bool
'notifications.newVolunteer' : bool
'notifications.pendingRequests' : bool
'notifications.memberChanges' : bool
```

#### Firestore (שרת)
```
/users/{userId}
├── name: "יוני כהן"
├── email: "yoni@email.com"
├── phone: "0501234567"
├── profileImageUrl: "👤" (אווטאר)
├── familyId: "family_abc" | null
├── created_at: timestamp
└── updated_at: timestamp
```

---

## שלבי העבודה

### שלב 0: סטטוס מסכי כניסה לאפליקציה (עדכון: 14/12/2025)

#### 📊 סיכום כללי (עדכון: 14/12/2025)
| מסך | סטטוס | אחוז השלמה |
|------|--------|------------|
| Welcome | ✅ מושלם | 100% |
| Login | ✅ מושלם | 100% |
| Register | ✅ מושלם | 100% |
| Onboarding | ✅ מושלם+ | 100%+ (7 שלבים במקום 3!) |
| Splash (Index) | ✅ מושלם | 100% |

#### ✅ Welcome Screen - מושלם!
**קובץ:** `lib/screens/welcome/welcome_screen.dart`
- [x] עיצוב Sticky Notes מלא
- [x] לוגו בפתק צהוב עם Hero animation
- [x] כותרת + כותרת משנה בפתק לבן
- [x] 3 יתרונות (Benefits) עם אנימציות כניסה
- [x] כפתור התחברות (→ Login)
- [x] כפתור הרשמה (→ Onboarding)
- [x] רקע מחברת NotebookBackground

#### ✅ Login Screen - מושלם!
**קובץ:** `lib/screens/auth/login_screen.dart`
- [x] עיצוב Sticky Notes מלא
- [x] שדה אימייל בפתק תכלת + ולידציה
- [x] שדה סיסמה בפתק ירוק + הצג/הסתר
- [x] קישור "שכחת סיסמה" עם Firebase sendPasswordResetEmail
- [x] כפתור התחברות עם loading state
- [x] קישור להרשמה בפתק ורוד
- [x] Shake animation בשגיאת ולידציה
- [x] חסימת Back button + SnackBar הסבר
- [x] הודעות שגיאה מותאמות לעברית
- [x] ניווט ל-Home אחרי הצלחה

#### ✅ Register Screen - מושלם!
**קובץ:** `lib/screens/auth/register_screen.dart`
- [x] עיצוב Sticky Notes מלא
- [x] שדה שם מלא בפתק סגול (מינימום 2 תווים)
- [x] שדה אימייל בפתק תכלת (ולידציה @)
- [x] **שדה טלפון בפתק כתום** (ולידציה ישראלית 05X-XXXXXXX) ✅
- [x] שדה סיסמה בפתק ירוק (מינימום 6 תווים)
- [x] שדה אימות סיסמה בפתק ורוד
- [x] כפתורי הצג/הסתר לסיסמאות
- [x] Shake animation בשגיאה
- [x] Firebase Auth + יצירת מסמך User (כולל phone!)
- [x] קישור להתחברות

#### ✅ Onboarding Screen - מושלם ומורחב!
**קבצים:**
- `lib/screens/onboarding/onboarding_screen.dart`
- `lib/screens/onboarding/widgets/onboarding_steps.dart`
- `lib/data/onboarding_data.dart`
- `lib/services/onboarding_service.dart`

**7 שלבים (יותר מהאיפיון!):**
1. [x] Welcome - ברוכים הבאים עם אנימציות
2. [x] Family Size - בחירת גודל משפחה (slider 1-10)
3. [x] Children - הוספת ילדים (שם + קטגוריית גיל)
4. [x] Stores - בחירת חנויות מועדפות (FilterChips)
5. [x] Shopping Frequency - תדירות קניות + ימים קבועים
6. [x] Sharing - שיתוף רשימות (Switch)
7. [x] Reminder - זמן תזכורת (TimePicker)
8. [x] Summary - סיכום כל ההגדרות

**תכונות נוספות:**
- [x] Progress indicator + Progress dots
- [x] כפתור דילוג ("דלג")
- [x] כפתורי קודם/הבא עם states
- [x] שמירה ב-SharedPreferences (OnboardingData)
- [x] Validation מלא לכל השדות
- [x] אנימציות flutter_animate

#### ✅ Splash Screen - קיים! (IndexScreen)
**קובץ:** `lib/screens/index_screen.dart` + `lib/screens/index_view.dart`
- [x] לוגו MemoZap מרכזי עם אנימציות
- [x] Loading spinner עם הודעות מתחלפות
- [x] גלים מונפשים (Wave animation)
- [x] בדיקת Firebase Auth - האם יש משתמש מחובר?
- [x] בדיקת SharedPreferences - seen_onboarding
- [x] ניווט אוטומטי:
  - מחובר → Home Dashboard
  - לא מחובר + ראה onboarding → Login
  - לא מחובר + לא ראה → WelcomeScreen
- [x] מסך שגיאה עם כפתור Retry

---

### שלב 1: תשתית בסיסית ✅ הושלם (14/12/2025)
- [x] **Splash Screen קיים** (`lib/screens/index_screen.dart` - מושלם!)
- [x] **הוספת שדה טלפון להרשמה** (פתק כתום, ולידציה 05X-XXXXXXX)
- [x] עדכון מודל `UserEntity` עם שדה `phone`
- [x] עדכון `UserContext.signUp()` עם פרמטר phone
- [x] עדכון `UserRepository.createUser()` עם phone
- [x] עדכון מסך הרשמה (`register_screen.dart`)
- [ ] עדכון Firebase Security Rules (אופציונלי)

### שלב 2: מערכת קבוצות
- [ ] יצירת מודל `Group`
- [ ] יצירת collection `/groups/{groupId}` ב-Firestore
- [ ] מסך יצירת קבוצה (כמו וואטסאפ)
- [ ] בחירת סוג קבוצה (משפחה/ועד בית/ועד גן/אחר)
- [ ] הוספת חברים מאנשי קשר
- [ ] הגדרת הרשאות לחברים (בעלים/אדמין/חבר)
- [ ] מסך פרטי קבוצה ועריכה
- [ ] לוגיקת עזיבת קבוצה (ביטול סימונים, עדכון סטטיסטיקות)
- [ ] מסך מחיקת קבוצה (רק לבעלים)

### שלב 3: מזווה (משפחה בלבד)

#### 3.1: תשתית Firestore
- [ ] יצירת `/users/{userId}/inventory/` למשתמש בודד
- [ ] יצירת `/groups/{groupId}/inventory/` לקבוצת משפחה
- [ ] עדכון `inventory_provider.dart` לתמיכה בשני מיקומים
- [ ] לוגיקת מחיקת מזווה בהצטרפות למשפחה
- [ ] דיאלוג אישור מחיקה/העברה

#### 3.2: עדכון Model - `InventoryItem` (שדות חסרים)
- [ ] הוספת `expiry_date: DateTime?` - תאריך תפוגה
- [ ] הוספת `notes: String?` - הערות לפריט
- [ ] הוספת `is_recurring: bool` - מוצר קבוע (מתווסף לרשימות חדשות)
- [ ] הוספת `last_purchased: DateTime?` - תאריך קנייה אחרון
- [ ] הוספת `purchase_count: int` - מספר פעמים שנקנה
- [ ] הוספת `emoji: String?` - אמוג'י מותאם (אופציונלי)
- [ ] עדכון `toJson()` / `fromJson()` / `copyWith()`
- [ ] עדכון `inventory_item.g.dart` (build_runner)

#### 3.3: תיקון אמוג'י מיקומים - `StorageLocationsConfig`
- [ ] מקרר: ❄️ → 🧊
- [ ] מקפיא: 🧊 → ❄️
- [ ] מזווה: 🏠 → 🗄️
- [ ] משטח עבודה: 🗄️ → 🍳

#### 3.4: עדכון Dialog עריכה - `PantryItemDialog`
- [ ] הוספת שדה תאריך תפוגה (DatePicker)
- [ ] הוספת שדה הערות (TextField)
- [ ] הוספת Checkbox "מוצר קבוע"
- [ ] הצגת סטטיסטיקות (נקנה X פעמים, קנייה אחרונה)

#### 3.5: תכונות UI חדשות - `MyPantryScreen` / `StorageLocationManager`
- [ ] **Empty State** - מסך ריק עם הסבר והכוונה
- [ ] **כפתור [🛒] הוסף לרשימה** - ליד פריטים במלאי נמוך
- [ ] **Dialog בחירת רשימה** - לאיזו רשימה להוסיף
- [ ] **תצוגת תאריך תפוגה** - ⏰ עם צבע לפי קרבה (אדום/כתום)
- [ ] **סינון לפי תפוגה** - הוספה לתפריט סינון
- [ ] **תצוגת מוצר קבוע** - ⭐ ליד שם המוצר

#### 3.6: התראות מזווה
- [ ] **Dialog מלאי נמוך** - בכניסה לאפליקציה (אם יש 3+ פריטים במלאי נמוך)
- [ ] **Dialog תפוגה קרובה** - התראה על מוצרים שפג תוקפם בקרוב
- [ ] **הגדרות מזווה מהירות** - Dialog מ-[⚙️] במזווה

#### 3.7: זיהוי דפוסים (עתידי)
- [ ] לוגיקה לזיהוי מוצר קבוע (נקנה 4+ פעמים בחודש)
- [ ] Dialog הצעה להפוך למוצר קבוע
- [ ] שמירת העדפה "אל תשאל שוב על מוצר זה"

#### 3.8: קיים ועובד ✅
- [x] תצוגת פריטים לפי מיקומי אחסון
- [x] סינון לפי מיקום (tabs/cards)
- [x] חיפוש מוצר
- [x] מיון (שם/כמות/קטגוריה)
- [x] תצוגת Grid/List עם שמירת העדפה
- [x] הוספת פריט מקטלוג
- [x] הוספה ידנית
- [x] עריכת פריט
- [x] מחיקת פריט עם אישור
- [x] עדכון כמות מהיר (+/-)
- [x] אינדיקטור מלאי נמוך (⚠️)
- [x] מיקומים מותאמים אישית (הוספה/עריכה/מחיקה+Undo)
- [x] 43 קטגוריות מוצרים

### שלב 3.9: מסך רשימות - סטטוס

#### קיים ועובד ✅ (מסך רשימות מושלם!)

**מסך ראשי - `shopping_lists_screen.dart`:**
- [x] תצוגת רשימות פעילות (🔵)
- [x] תצוגת היסטוריה (✅) עם pagination ("טען עוד")
- [x] חיפוש רשימות
- [x] סינון לפי סוג רשימה (Dropdown)
- [x] מיון (תאריך/שם/תקציב)
- [x] Pull to refresh
- [x] Empty/Error/Loading states (עם Skeleton)
- [x] Sticky Notes Design System
- [x] FAB יצירת רשימה
- [x] אנימציות כניסה לכרטיסים

**כרטיס רשימה - `ShoppingListTile`:**
- [x] שם רשימה + תג סוג (אמוג'י+טקסט)
- [x] מספר פריטים + תאריך עדכון
- [x] Progress bar (נקנו/סה"כ)
- [x] תג דחיפות (היום/מחר/X ימים)
- [x] תג "משותפת"
- [x] כפתור "התחל קנייה" (לרשימות עם מוצרים)
- [x] כפתור "הוסף מוצרים" (לרשימה ריקה)
- [x] תפריט (עריכה/מחיקה) + Undo
- [x] Border צבעוני לפי סטטוס

**מסך יצירת רשימה - `create_list_screen.dart`:**
- [x] שדה שם רשימה + ולידציה
- [x] בחירת סוג רשימה (7 סוגים: סופר/פארם/ירקן/קצב/מאפייה/שוק/אחר)
- [x] Preview סוג רשימה (אמוג'י גדול)
- [x] שדה תקציב (אופציונלי)
- [x] שדה תאריך אירוע (DatePicker)
- [x] בחירת תבנית מוכנה
- [x] בדיקת שם כפול

#### חסר / לעתיד
- [ ] **תמיכה ב-5 סוגי רשימות חדשים** - הצבעה/מי מביא/צ'קליסט/סקר (כרגע רק רשימות קניות)
- [ ] **ארכיון נפרד** - יש status archived אבל אין UI נפרד
- [ ] **כפתור שיתוף רשימה** - יש תג "משותפת" אבל לא כפתור ליצירת שיתוף
- [ ] **סינון לפי קבוצה** - להציג רק רשימות של קבוצה מסוימת

---

### שלב 4: סוגי רשימות

#### 4.1: רשימת קניות (משפחה בלבד)
- [ ] כפתור "התחל קנייה" (רק למשפחה)
- [ ] תצוגת מצב קנייה עם [+] [-] לכמויות
- [ ] סימון פריטים שלא נקנו בעבר (⚠️)
- [ ] כפתור "סיים קנייה"
- [ ] העברת פריטים שנקנו למזווה
- [ ] שמירת פריטים שלא נקנו ברשימה

#### 4.2: רשימת "מי מביא"
- [ ] הגדרת `needed_count` לכל פריט
- [ ] UI לסימון "אני מביא"
- [ ] תצוגת X/Y מתנדבים
- [ ] רשימת שמות מתנדבים (עם "..." להרבה)
- [ ] חסימה כשמלא (X=Y)
- [ ] ביטול סימון

#### 4.3: רשימת הצבעה
- [ ] מסך יצירת הצבעה עם הגדרות
- [ ] בחירת תאריך סיום
- [ ] הצבעה גלויה/חשאית
- [ ] הגדרת מה קורה בתיקו
- [ ] UI הצבעה (בעד/נגד/נמנע)
- [ ] תצוגת תוצאות (בר התקדמות)
- [ ] לוגיקת תיקו והכרעת בעלים

#### 4.4: צ'קליסט פשוט
- [ ] סימון V פשוט
- [ ] זמין לכל סוגי הקבוצות

### שלב 5: היסטוריה וקבלות (משפחה בלבד)
- [ ] יצירת מודל `Receipt`
- [ ] שמירת קבלה בסיום קנייה
- [ ] מסך היסטוריית קניות
- [ ] תצוגת פרטי קבלה
- [ ] זיהוי דפוסים: הצעה למוצר קבוע

### שלב 6: התראות
- [ ] התראה על הזמנה לקבוצה
- [ ] התראה על "אני מביא" חדש
- [ ] התראה על הצבעה חדשה
- [ ] התראה על תיקו (לבעלים)
- [ ] התראה על חבר שעזב (לאדמינים)
- [ ] התראה על מלאי נמוך (למשפחה)

### שלב 7: מבנה ניווט חדש
- [ ] עדכון `MainNavigationScreen` ל-4 טאבים: בית | משפחה | קבוצות | הגדרות
- [ ] יצירת מסך `FamilyScreen` עם TabBar פנימי (רשימות | מזווה | אישי)
- [ ] יצירת מסך `GroupsScreen` - רשימת כל הקבוצות
- [ ] עדכון ניווט בין מסכים

### שלב 8: מסך הבית החדש
- [ ] עיצוב מחדש של `HomeDashboardScreen`
- [ ] כותרת ברכה עם שם המשתמש
- [ ] אזור "דורש תשומת לב" - אגרגציה מכל הקבוצות
- [ ] כפתורי גישה מהירה (מזווה, קנייה)
- [ ] Feed פעילות אחרונה
- [ ] קיצורי קבוצות (chips)

### שלב 9: מסך הגדרות מעודכן
- [ ] ארגון מחדש של `SettingsScreen` לפי האיפיון החדש
- [ ] הסרת סקשן "ניהול קבוצה" (עובר לטאב קבוצות)
- [ ] הוספת סקשן התראות עם toggles
- [ ] הוספת סקשן הגדרות כלליות (ערכת נושא)
- [ ] הוספת סקשן מידע (גרסה, תנאי שימוש, פרטיות)
- [ ] עדכון התנתקות עם אישור משופר

### שלב 10: רפקטורינג מבנה קבצים

#### 10.1: בעיות שזוהו במבנה הנוכחי

**חוסר עקביות בארכיטקטורה:**
```
lib/
├── features/              ← Feature-based (רק household!)
│   └── household/
├── models/                ← Layer-based (כל השאר)
├── screens/
├── services/
└── providers/
```

**בעיות נוספות:**
- `models/` עמוס (27 קבצים, מחציתם .g.dart)
- `screens/sharing/` כפילות עם `features/household/` (הזמנות/בקשות)
- גבולות לא ברורים בין services לrepositories
- תתי-תיקיות ב-shopping עם קובץ אחד בלבד
- קבצים גדולים מדי (5+ קבצים מעל 1000 שורות)

#### 10.2: מבנה חדש מומלץ (Feature-First)

```
lib/
├── core/                          ← קוד משותף (לא לשנות)
│   ├── ui_constants.dart
│   └── status_colors.dart
│
├── config/                        ← הגדרות (לא לשנות)
│   ├── app_config.dart
│   ├── list_types_config.dart
│   └── ...
│
├── shared/                        ← 🆕 קוד משותף בין features
│   ├── models/
│   │   ├── user_entity.dart
│   │   └── timestamp_converter.dart
│   ├── widgets/
│   │   ├── notebook_background.dart
│   │   ├── sticky_note.dart
│   │   └── sticky_button.dart
│   ├── services/
│   │   └── auth_service.dart
│   └── providers/
│       └── user_context.dart
│
├── features/                      ← 🆕 כל הפיצ'רים
│   │
│   ├── auth/                      ← 🆕 הרשמה/התחברות
│   │   ├── screens/
│   │   │   ├── login_screen.dart
│   │   │   └── register_screen.dart
│   │   └── widgets/
│   │
│   ├── onboarding/                ← 🆕 (קיים ב-screens)
│   │   ├── screens/
│   │   │   └── onboarding_screen.dart
│   │   ├── widgets/
│   │   │   └── onboarding_steps.dart
│   │   └── data/
│   │       └── onboarding_data.dart
│   │
│   ├── home/                      ← 🆕 דשבורד
│   │   ├── screens/
│   │   │   └── home_dashboard_screen.dart
│   │   └── widgets/
│   │       ├── attention_card.dart
│   │       └── smart_suggestions_card.dart
│   │
│   ├── shopping/                  ← 🆕 רשימות קניות (קיים)
│   │   ├── models/
│   │   │   ├── shopping_list.dart
│   │   │   └── unified_list_item.dart
│   │   ├── screens/
│   │   │   ├── shopping_lists_screen.dart
│   │   │   ├── create_list_screen.dart
│   │   │   ├── shopping_list_details_screen.dart
│   │   │   └── active_shopping_screen.dart
│   │   ├── widgets/
│   │   │   ├── shopping_list_tile.dart
│   │   │   └── product_selection_bottom_sheet.dart
│   │   ├── providers/
│   │   │   └── shopping_lists_provider.dart
│   │   └── repositories/
│   │       ├── shopping_lists_repository.dart
│   │       └── firebase_shopping_lists_repository.dart
│   │
│   ├── pantry/                    ← 🆕 מזווה (קיים חלקית)
│   │   ├── models/
│   │   │   └── inventory_item.dart
│   │   ├── screens/
│   │   │   └── my_pantry_screen.dart
│   │   ├── widgets/
│   │   │   ├── pantry_item_dialog.dart
│   │   │   └── storage_location_manager.dart
│   │   ├── providers/
│   │   │   └── inventory_provider.dart
│   │   └── repositories/
│   │       └── firebase_inventory_repository.dart
│   │
│   ├── groups/                    ← 🆕 מאחד household + sharing
│   │   ├── models/
│   │   │   ├── household_member.dart
│   │   │   ├── household_invite.dart
│   │   │   └── household_join_request.dart
│   │   ├── screens/
│   │   │   ├── groups_screen.dart (חדש - רשימת קבוצות)
│   │   │   ├── group_details_screen.dart
│   │   │   ├── create_group_screen.dart
│   │   │   ├── household_members_screen.dart
│   │   │   ├── create_invite_screen.dart
│   │   │   └── join_household_screen.dart
│   │   ├── widgets/
│   │   │   └── group_card.dart
│   │   └── services/
│   │       └── household_service.dart
│   │
│   ├── settings/                  ← 🆕 הגדרות
│   │   ├── screens/
│   │   │   ├── settings_screen.dart
│   │   │   └── manage_users_screen.dart
│   │   └── widgets/
│   │
│   └── receipts/                  ← 🆕 קבלות והיסטוריה
│       ├── models/
│       │   └── receipt.dart
│       ├── screens/
│       │   └── receipts_screen.dart
│       ├── providers/
│       │   └── receipt_provider.dart
│       └── repositories/
│           └── firebase_receipt_repository.dart
│
├── l10n/                          ← שפות (לא לשנות)
│   └── app_strings.dart
│
├── layout/                        ← (לא לשנות)
│   └── app_layout.dart
│
├── theme/                         ← (לא לשנות)
│   └── app_theme.dart
│
└── main.dart
```

#### 10.3: קבצים למחיקה / מיזוג

**למחיקה (לא בשימוש או כפילות):**
- [ ] `lib/screens/sharing/` - למזג עם `features/groups/`
- [ ] `lib/screens/welcome/welcome_screen.dart` - לבדוק אם בשימוש
- [ ] `lib/widgets/common/benefit_tile.dart` - לבדוק אם בשימוש

**למיזוג:**
- [ ] `lib/features/household/` → `lib/features/groups/`
- [ ] `lib/screens/sharing/` → `lib/features/groups/screens/`

#### 10.4: קבצים גדולים לפיצול (מעל 800 שורות)

| קובץ | שורות | המלצה |
|------|-------|-------|
| `app_strings.dart` | 1476 | לפצל לפי feature |
| `active_shopping_screen.dart` | 1209 | להוציא widgets |
| `shopping_list_details_screen.dart` | 1142 | להוציא widgets |
| `storage_location_manager.dart` | 1132 | להוציא dialogs |
| `shopping_lists_provider.dart` | 1070 | לפצל לוגיקה |
| `settings_screen.dart` | 967 | להוציא sections |
| `onboarding_steps.dart` | 967 | להוציא steps בודדים |
| `user_context.dart` | 936 | לפצל לservices |

#### 10.5: סדר ביצוע הרפקטורינג (מומלץ)

**שלב א': הכנה (לא שובר קוד)**
- [ ] יצירת תיקיית `lib/shared/` והעברת קבצים משותפים
- [ ] יצירת תיקיית `lib/features/` ריקה

**שלב ב': מיזוג groups (חשוב!)**
- [ ] מיזוג `features/household/` + `screens/sharing/` → `features/groups/`
- [ ] עדכון imports בכל הקבצים
- [ ] מחיקת תיקיות ישנות

**שלב ג': העברת features קיימים**
- [ ] `screens/shopping/` → `features/shopping/`
- [ ] `screens/pantry/` → `features/pantry/`
- [ ] `screens/auth/` → `features/auth/`
- [ ] `screens/settings/` → `features/settings/`
- [ ] `screens/home/` → `features/home/`
- [ ] `screens/onboarding/` → `features/onboarding/`

**שלב ד': ארגון models**
- [ ] העברת models ספציפיים לfeatures שלהם
- [ ] השארת models משותפים ב-`shared/models/`

**שלב ה': ארגון providers/repositories**
- [ ] העברה לfeatures המתאימים
- [ ] השארת משותפים ב-`shared/`

**שלב ו': פיצול קבצים גדולים**
- [ ] `app_strings.dart` → קבצי שפה לפי feature
- [ ] הוצאת widgets מקבצי screen גדולים

#### 10.6: TODOs בקוד שנמצאו

```
// TODO: checkedBy + checkedAt יתווספו ב-UnifiedListItem
// TODO: לממש stream ממוזג עם rxdart או CombineLatestStream
// TODO: Create default list
// TODO: Call PendingRequestsService.approveRequest()
// TODO: Call PendingRequestsService.rejectRequest()
```

#### 10.7: הערות חשובות לרפקטורינג

⚠️ **לא לשנות:**
- קבצי `.g.dart` (generated)
- `lib/core/`, `lib/config/`, `lib/theme/`, `lib/l10n/`, `lib/layout/`

✅ **טיפים:**
- להשתמש ב-`git mv` לשמירת היסטוריה
- לעדכן imports ב-batch עם IDE
- לבדוק build אחרי כל שלב

---

## הערות נוספות

### דברים שלא נעשה כרגע
- שליחת SMS אוטומטית
- Push Notifications
- בחירת חנויות מועדפות
- סריקת ברקוד למזווה

### דברים לשקול בעתיד
- מזווה לקבוצות עסקיות (משרדים, עסקים קטנים)
- תפוגת קוד הזמנה (כרגע 7 ימים)
- הגבלת מספר הזמנות פעילות לקבוצה
- ייצוא/ייבוא רשימות
- סטטיסטיקות הוצאות (מחירים בקבלות)
- תזכורות להצבעות שעומדות להיסגר
